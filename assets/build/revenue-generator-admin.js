!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){"use strict";var a=function(e,t){let n;return function(){const a=this,r=arguments;clearTimeout(n),n=setTimeout((function(){e.apply(a,r)}),t)}};n.d(t,"a",(function(){return a}))},function(e,t){var n;(n=jQuery).fn.showSnackbar=function(e,t){const a=n(this);a.text(e),a.addClass("rev-gen-snackbar--show"),setTimeout((function(){a.removeClass("rev-gen-snackbar--show")}),t)}},function(e,t,n){var a;!function(){"use strict";var r={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function o(e){return s(l(e),arguments)}function i(e,t){return o.apply(null,[e].concat(t||[]))}function s(e,t){var n,a,i,s,c,l,p,u,d,h=1,g=e.length,v="";for(a=0;a<g;a++)if("string"==typeof e[a])v+=e[a];else if("object"==typeof e[a]){if((s=e[a]).keys)for(n=t[h],i=0;i<s.keys.length;i++){if(null==n)throw new Error(o('[sprintf] Cannot access property "%s" of undefined value "%s"',s.keys[i],s.keys[i-1]));n=n[s.keys[i]]}else n=s.param_no?t[s.param_no]:t[h++];if(r.not_type.test(s.type)&&r.not_primitive.test(s.type)&&n instanceof Function&&(n=n()),r.numeric_arg.test(s.type)&&"number"!=typeof n&&isNaN(n))throw new TypeError(o("[sprintf] expecting number but found %T",n));switch(r.number.test(s.type)&&(u=n>=0),s.type){case"b":n=parseInt(n,10).toString(2);break;case"c":n=String.fromCharCode(parseInt(n,10));break;case"d":case"i":n=parseInt(n,10);break;case"j":n=JSON.stringify(n,null,s.width?parseInt(s.width):0);break;case"e":n=s.precision?parseFloat(n).toExponential(s.precision):parseFloat(n).toExponential();break;case"f":n=s.precision?parseFloat(n).toFixed(s.precision):parseFloat(n);break;case"g":n=s.precision?String(Number(n.toPrecision(s.precision))):parseFloat(n);break;case"o":n=(parseInt(n,10)>>>0).toString(8);break;case"s":n=String(n),n=s.precision?n.substring(0,s.precision):n;break;case"t":n=String(!!n),n=s.precision?n.substring(0,s.precision):n;break;case"T":n=Object.prototype.toString.call(n).slice(8,-1).toLowerCase(),n=s.precision?n.substring(0,s.precision):n;break;case"u":n=parseInt(n,10)>>>0;break;case"v":n=n.valueOf(),n=s.precision?n.substring(0,s.precision):n;break;case"x":n=(parseInt(n,10)>>>0).toString(16);break;case"X":n=(parseInt(n,10)>>>0).toString(16).toUpperCase()}r.json.test(s.type)?v+=n:(!r.number.test(s.type)||u&&!s.sign?d="":(d=u?"+":"-",n=n.toString().replace(r.sign,"")),l=s.pad_char?"0"===s.pad_char?"0":s.pad_char.charAt(1):" ",p=s.width-(d+n).length,c=s.width&&p>0?l.repeat(p):"",v+=s.align?d+n+c:"0"===l?d+c+n:c+d+n)}return v}var c=Object.create(null);function l(e){if(c[e])return c[e];for(var t,n=e,a=[],o=0;n;){if(null!==(t=r.text.exec(n)))a.push(t[0]);else if(null!==(t=r.modulo.exec(n)))a.push("%");else{if(null===(t=r.placeholder.exec(n)))throw new SyntaxError("[sprintf] unexpected placeholder");if(t[2]){o|=1;var i=[],s=t[2],l=[];if(null===(l=r.key.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(i.push(l[1]);""!==(s=s.substring(l[0].length));)if(null!==(l=r.key_access.exec(s)))i.push(l[1]);else{if(null===(l=r.index_access.exec(s)))throw new SyntaxError("[sprintf] failed to parse named argument key");i.push(l[1])}t[2]=i}else o|=2;if(3===o)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");a.push({placeholder:t[0],param_no:t[1],keys:t[2],sign:t[3],pad_char:t[4],align:t[5],width:t[6],precision:t[7],type:t[8]})}n=n.substring(t[0].length)}return c[e]=a}t.sprintf=o,t.vsprintf=i,"undefined"!=typeof window&&(window.sprintf=o,window.vsprintf=i,void 0===(a=function(){return{sprintf:o,vsprintf:i}}.call(t,n,t,e))||(e.exports=a))}()},function(e,t,n){e.exports=function(e,t){var n,a,r,o=0;function i(){var t,i,s=a,c=arguments.length;e:for(;s;){if(s.args.length===arguments.length){for(i=0;i<c;i++)if(s.args[i]!==arguments[i]){s=s.next;continue e}return s!==a&&(s===r&&(r=s.prev),s.prev.next=s.next,s.next&&(s.next.prev=s.prev),s.next=a,s.prev=null,a.prev=s,a=s),s.val}s=s.next}for(t=new Array(c),i=0;i<c;i++)t[i]=arguments[i];return s={args:t,val:e.apply(null,t)},a?(a.prev=s,s.next=a):r=s,o===n?(r=r.prev).next=null:o++,a=s,s.val}return t&&t.maxSize&&(n=t.maxSize),i.clear=function(){a=null,r=null,o=0},i}},function(e,t,n){n(9),e.exports=n(5)},function(e,t,n){},,,,function(e,t,n){"use strict";n.r(t);n(1);var a,r,o,i,s,c=n(0);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}(a=jQuery)((function(){!function(){const e={body:a("body"),requestSent:!1,somethingChanged:!1,settingsMerchantID:".rev-gen-settings-main-merchant-id",settingsMerchantKey:".rev-gen-settings-main-merchant-key",settingsModalClose:".rev-gen-settings-main-info-modal-cross",rgDashboard:".rev-gen-dashboard-main",helpGAButton:".rev-gen-settings-main-option-info",helpGAModal:".rev-gen-settings-main-info-modal",rgGALaterpayRow:".rg-laterpay-row",rgGAUserRow:".rg-user-row",laterpayLoader:a(".laterpay-loader-wrapper"),rgLayoutWrapper:a(".rev-gen-layout-wrapper"),settingsWrapper:a(".rev-gen-settings-main"),settingsPerMonth:a(".rev-gen-settings-main-post-per-month"),settingsGAUserID:a(".rev-gen-settings-main-ga-code-user"),settingsSaveButton:a(".rev-gen-settings-main-save-settings"),rgGAUserStatus:a("#rgGAUserStatus"),rgGALaterPayStatus:a("#rgGALaterPayStatus"),snackBar:a("#rg_js_SnackBar"),everyInput:a("table.rev-gen-settings-main-table input"),triggerPopup:a(".triggerPopup")},t=function(){e.laterpayLoader.css("display","flex")},n=function(t){a.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:t,dataType:"json"}).done((function(t){e.laterpayLoader.hide(),e.snackBar.showSnackbar(t.data.msg,1500),t.data.merchant?(r(e.settingsMerchantID),r(e.settingsMerchantKey)):(o(e.settingsMerchantID),o(e.settingsMerchantKey)),e.requestSent=!1}))},r=function(e){a(e).css("border-color","#19e4ac"),setTimeout((function(){a(e).removeAttr("style")}),5e3)},o=function(e){a(e).css("border-color","#ff1939"),setTimeout((function(){a(e).removeAttr("style")}),5e3)},i=function(e){if(!0===e)return t=window,n=document,a="script",r="rgga",t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,o=n.createElement(a),i=n.getElementsByTagName(a)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(o,i),window[window.GoogleAnalyticsObject||"rgga"];var t,n,a,r,o,i},s=function(e,t,n,a,r,o){const s=i(e);"function"==typeof s&&(s("create",revenueGeneratorGlobalOptions.rg_tracking_id,"auto","rgParentTracker"),s("rgParentTracker.send","event",{eventCategory:a,eventAction:n,eventLabel:t,eventValue:r,nonInteraction:o}))},l=function(e,t,n,a,r,o){const s=i(e);"function"==typeof s&&(s("create",revenueGeneratorGlobalOptions.rg_user_tracking_id,"auto","rgUserTracker"),s("rgUserTracker.send","event",{eventCategory:a,eventAction:n,eventLabel:t,eventValue:r,nonInteraction:o}))},p=function(e,t,n,a,r,o,i,s){e("create",t,"auto",n),e(n+".send","event",{eventCategory:o,eventAction:a,eventLabel:r,eventValue:i,nonInteraction:s})};window.rgGlobal={sendLPGAEvent(e,t,n,a,r){void 0===r&&(r=!1);let o=!1;const i=function(){if("boolean"==typeof window.mi_track_user&&!0===window.mi_trac_user)return window[window.GoogleAnalyticsObject||"__gaTracker"]}();let c="";const u=revenueGeneratorGlobalOptions.rg_user_tracking_id,d=revenueGeneratorGlobalOptions.rg_tracking_id;u.length>0&&d.length>0?"function"==typeof i?(c=i.getAll(),c.forEach((function(s){if(u===s.get("trackingId")){o=!0;const c=s.get("name");i(c+".send","event",{eventCategory:t,eventAction:e,eventLabel:n,eventValue:a,nonInteraction:r})}})),!0===o?p(d,"rgParentTracker",e,n,t,a,r):(p(i,d,"rgParentTracker",e,n,t,a,r),p(i,u,"rgUserTracker",e,n,t,a,r))):(s(!0,n,e,t,a,r),l(!0,n,e,t,a,r)):u.length>0&&0===d.length?"function"==typeof i?(c=i.getAll(),c.forEach((function(s){if(u===s.get("trackingId")){o=!0;const c=s.get("name");i(c+".send","event",{eventCategory:t,eventAction:e,eventLabel:n,eventValue:a,nonInteraction:r})}})),!0!==o&&l(!0,n,e,t,a,r)):l(!0,n,e,t,a,r):0===u.length&&d.length>0&&("function"==typeof i?p(i,d,"rgParentTracker",e,n,t,a,r):s(!0,n,e,t,a,r))}},function(){if(e.settingsSaveButton.on("click",Object(c.a)((function(){if(!e.requestSent){e.requestSent=!0;let r=0,o=0,i="low";a.each(e.settingsPerMonth,(function(e,t){a(t).is(":checked")&&(i=a(t).val())}));const s=a(e.settingsMerchantID).val(),c=a(e.settingsMerchantKey).val(),l=e.settingsGAUserID.val();e.rgGAUserStatus.is(":checked")&&(r=e.rgGAUserStatus.val()),e.rgGALaterPayStatus.is(":checked")&&(o=e.rgGALaterPayStatus.val());const p={action:"rg_update_settings",average_post_publish_count:i,merchant_id:s,merchant_key:c,rg_personal_ga_ua_id:l,rg_ga_personal_enabled_status:r,rg_ga_enabled_status:o,security:revenueGeneratorGlobalOptions.rg_global_config_nonce};t(),n(p),e.requestSent=!1,e.somethingChanged=!1}}),500)),e.settingsPerMonth.on("click",(function(){e.settingsPerMonth.removeAttr("checked"),a(this).prop("checked",!0)})),e.everyInput.on("change",(function(){e.somethingChanged=!0})),a(window).on("beforeunload",(function(t){if(e.somethingChanged)return t.preventDefault(),!1})),e.rgLayoutWrapper.on("click",(function(){e.helpGAModal&&e.helpGAModal.length>0&&(a(e.helpGAModal).remove(),e.body.removeClass("modal-blur"),a(e.rgGAUserRow).css("background-color","inherit"),a(e.rgGALaterpayRow).css("background-color","inherit"),e.body.find("input").removeClass("input-blur"))})),e.body.on("click",e.helpGAButton,(function(){const t=a(this).attr("data-info-for"),n=e.settingsWrapper.find(e.helpGAModal);if(n.length)e.body.removeClass("modal-blur"),e.body.find("input").removeClass("input-blur"),n.remove();else{const n=wp.template(`revgen-info-${t}`);e.settingsWrapper.append(n),e.body.addClass("modal-blur"),e.body.find("input").addClass("input-blur"),"user"===t?(a(e.rgGAUserRow).find("input").removeClass("input-blur"),a(e.rgGALaterpayRow).removeAttr("style"),a(e.rgGAUserRow).css("background-color","#fff")):(a(e.rgGALaterpayRow).find("input").removeClass("input-blur"),a(e.rgGAUserRow).removeAttr("style"),a(e.rgGALaterpayRow).css("background-color","#fff"))}})),e.body.on("click",e.settingsModalClose,(function(){a(e.helpGAModal).remove(),e.body.removeClass("modal-blur"),a(e.rgGAUserRow).css("background-color","inherit"),a(e.rgGALaterpayRow).css("background-color","inherit"),e.body.find("input").removeClass("input-blur")})),a(".rev-gen__select2",e.rgDashboard).select2({width:"auto",dropdownAutoWidth:!0,dropdownCssClass:":all:",minimumResultsForSearch:-1}),a(e.rgDashboard).length>0){const t=a(e.rgDashboard).data("current"),n="LP RevGen";rgGlobal.sendLPGAEvent("View Dashboard",n,t,0,!0)}}()}()})),function(e){e((function(){!function(){const t={body:e("body"),welcomeScreenWrapper:e(".welcome-screen-wrapper"),lowPostCard:e("#rg_js_lowPostCard"),highPostCard:e("#rg_js_highPostCard"),isContribution:e("#rg_Contribution"),isPaywall:e("#rg_Paywall"),laterpayTrackingStatus:e(".welcome-screen-tracking"),snackBar:e("#rg_js_SnackBar")},n=function(e,t){const n={action:"rg_update_global_config",config_key:"is_welcome_done",config_value:e,rg_ga_enabled_status:t,security:revenueGeneratorGlobalOptions.rg_global_config_nonce};r(revenueGeneratorGlobalOptions.ajaxUrl,n)},a=function(e="low"){const t={action:"rg_update_global_config",config_key:"average_post_publish_count",config_value:e,security:revenueGeneratorGlobalOptions.rg_global_config_nonce};r(revenueGeneratorGlobalOptions.ajaxUrl,t)},r=function(n,a){e.ajax({url:n,method:"POST",data:a,dataType:"json"}).done((function(e){t.snackBar.showSnackbar(e.msg,500),t.welcomeScreenWrapper.fadeOut(500,(function(){window.location.reload()}))}))};t.lowPostCard.on("click",(function(){a("low"),rgGlobal.sendLPGAEvent("Paywall Landing Page","LP RevGen Paywall Tutorial","Fewer than 10",0,!0)})),t.highPostCard.on("click",(function(){a("high"),rgGlobal.sendLPGAEvent("Paywall Landing Page","LP RevGen Paywall Tutorial","10+",0,!0)})),t.isContribution.on("click",(function(){let e=0;t.laterpayTrackingStatus.is(":checked")&&(e=1),n("contribution",e),rgGlobal.sendLPGAEvent("Welcome Landing Page","LP RevGen","Contributions",0,!0)})),t.isPaywall.on("click",(function(){let e=0;t.laterpayTrackingStatus.is(":checked")&&(e=1),n("paywall",e),rgGlobal.sendLPGAEvent("Welcome Landing Page","LP RevGen","Paywall",0,!0)})),t.laterpayTrackingStatus.on("click",(function(){"checked"===e(this).attr("checked")?e(this).attr("checked","checked"):e(this).removeAttr("checked")}))}()}))}(jQuery),r={"(":9,"!":8,"*":7,"/":7,"%":7,"+":6,"-":6,"<":5,"<=":5,">":5,">=":5,"==":4,"!=":4,"&&":3,"||":2,"?":1,"?:":1},o=["(","?"],i={")":["("],":":["?","?:"]},s=/<=|>=|==|!=|&&|\|\||\?:|\(|!|\*|\/|%|\+|-|<|>|\?|\)|:/;var p={"!":function(e){return!e},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":function(e,t){return e%t},"+":function(e,t){return e+t},"-":function(e,t){return e-t},"<":function(e,t){return e<t},"<=":function(e,t){return e<=t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"==":function(e,t){return e===t},"!=":function(e,t){return e!==t},"&&":function(e,t){return e&&t},"||":function(e,t){return e||t},"?:":function(e,t,n){if(e)throw t;return n}};function u(e){var t=function(e){for(var t,n,a,c,l=[],p=[];t=e.match(s);){for(n=t[0],(a=e.substr(0,t.index).trim())&&l.push(a);c=p.pop();){if(i[n]){if(i[n][0]===c){n=i[n][1]||n;break}}else if(o.indexOf(c)>=0||r[c]<r[n]){p.push(c);break}l.push(c)}i[n]||p.push(n),e=e.substr(t.index+n.length)}return(e=e.trim())&&l.push(e),l.concat(p.reverse())}(e);return function(e){return function(e,t){var n,a,r,o,i,s,c=[];for(n=0;n<e.length;n++){if(i=e[n],o=p[i]){for(a=o.length,r=Array(a);a--;)r[a]=c.pop();try{s=o.apply(null,r)}catch(e){return e}}else s=t.hasOwnProperty(i)?t[i]:+i;c.push(s)}return c[0]}(t,e)}}var d={contextDelimiter:"",onMissingKey:null};function h(e,t){var n;for(n in this.data=e,this.pluralForms={},this.options={},d)this.options[n]=void 0!==t&&n in t?t[n]:d[n]}h.prototype.getPluralForm=function(e,t){var n,a,r,o,i=this.pluralForms[e];return i||("function"!=typeof(r=(n=this.data[e][""])["Plural-Forms"]||n["plural-forms"]||n.plural_forms)&&(a=function(e){var t,n,a;for(t=e.split(";"),n=0;n<t.length;n++)if(0===(a=t[n].trim()).indexOf("plural="))return a.substr(7)}(n["Plural-Forms"]||n["plural-forms"]||n.plural_forms),o=u(a),r=function(e){return+o({n:e})}),i=this.pluralForms[e]=r),i(t)},h.prototype.dcnpgettext=function(e,t,n,a,r){var o,i,s;return o=void 0===r?0:this.getPluralForm(e,r),i=n,t&&(i=t+this.options.contextDelimiter+n),(s=this.data[e][i])&&s[o]?s[o]:(this.options.onMissingKey&&this.options.onMissingKey(n,e),0===o?n:a)};var g=n(3),v=n.n(g),f=n(2),m=n.n(f);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w={"":{plural_forms:function(e){return 1===e?0:1}}},_=v()(console.error),P=new h({});function k(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default";P.data[t]=b({},w,{},P.data[t],{},e),P.data[t][""]=b({},w[""],{},P.data[t][""])}function O(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;return P.data[e]||k(void 0,e),P.dcnpgettext(e,t,n,a,r)}function G(e,t){return O(t,void 0,e)}function x(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return m.a.sprintf.apply(m.a,[e].concat(n))}catch(t){return _("sprintf error: \n\n"+t.toString()),e}}class C{constructor(e){this.options={id:"",templateData:{},onConfirm:()=>{},onCancel:()=>{},autoShow:!0,...e},this.init()}init(){this.options.autoShow&&this.show()}show(){if(!this.options.id)return;const e=document.querySelector("body"),t=wp.template(this.options.id),n=this.options.templateData?t(this.options.templateData):t();e.insertAdjacentHTML("beforeend",n),this.el=document.getElementById(this.options.id),this.bindEvents()}hide(){document.querySelector(".rev-gen-modal-overlay").remove(),this.el.remove()}bindEvents(){this.el.querySelector("#rg_js_modal_confirm").addEventListener("click",this.onConfirm.bind(this)),this.el.querySelector("#rg_js_modal_cancel").addEventListener("click",this.onCancel.bind(this))}onConfirm(){this.options.onConfirm(),this.hide()}onCancel(){this.options.onCancel(),this.hide()}}!function(e){e((function(){!function(){const t={body:e("body"),requestSent:!1,isPublish:!1,previewWrapper:e(".rev-gen-preview-main, .rev-gen-contribution-main"),layoutWrapper:e(".rev-gen-layout-wrapper"),laterpayLoader:e(".laterpay-loader-wrapper"),noResultsWrapper:".rev-gen-preview-main-no-result",contributionBox:e(".rev-gen-contribution-main--box"),searchContentWrapper:e(".rev-gen-preview-main--search"),searchContent:e("#rg_js_searchContent"),currentPaywall:e("#rg_currentPaywall"),searchResultWrapper:e(".rev-gen-preview-main--search-results"),searchResultItem:".rev-gen-preview-main--search-results-item",postPreviewWrapper:e("#rg_js_postPreviewWrapper"),postTitle:".rev-gen-preview-main--post--title",postExcerpt:e("#rg_js_postPreviewExcerpt"),postContent:e("#rg_js_postPreviewContent"),purchaseOverlay:e("#rg_js_purchaseOverlay"),purchaseOverlayRemove:".rg-purchase-overlay-remove",purchaseOptionItems:".rg-purchase-overlay-purchase-options",purchaseOptionItem:".rg-purchase-overlay-purchase-options-item",purchaseOptionItemInfo:".rg-purchase-overlay-purchase-options-item-info",purchaseOptionItemTitle:".rg-purchase-overlay-purchase-options-item-info-title",purchaseOptionItemDesc:".rg-purchase-overlay-purchase-options-item-info-description",purchaseItemPriceIcon:".rg-purchase-overlay-purchase-options-item-price-icon",purchaseOptionItemPrice:".rg-purchase-overlay-purchase-options-item-price-span",purchaseOptionPriceSymbol:".rg-purchase-overlay-purchase-options-item-price-symbol",optionArea:".rg-purchase-overlay-option-area",addOptionArea:".rg-purchase-overlay-option-area-add-option",previewSecondItem:".rg-purchase-overlay-purchase-options .option-item-second",editOption:".rg-purchase-overlay-option-edit",optionRemove:".rg-purchase-overlay-option-remove",purchaseOptionType:"#rg_js_purchaseOptionType",optionManager:".rg-purchase-overlay-option-manager",individualPricingWrapper:".rg-purchase-overlay-option-manager-pricing",individualPricingSelection:".rg-purchase-overlay-option-pricing-selection",purchaseRevenueWrapper:".rg-purchase-overlay-option-manager-revenue",purchaseRevenueSelection:".rg-purchase-overlay-option-revenue-selection",durationWrapper:".rg-purchase-overlay-option-manager-duration",periodCountSelection:".rg-purchase-overlay-option-manager-duration-count",periodSelection:".rg-purchase-overlay-option-manager-duration-period",entitySelection:".rg-purchase-overlay-option-manager-entity",addPaywall:"#rj_js_addNewPaywall",gotoDashboard:"#rg_js_gotoDashboard",actionsWrapper:e(".rev-gen-preview-main--paywall-actions"),actionButtons:e(".rev-gen-preview-main--paywall-actions-update"),activatePaywall:e("#rg_js_activatePaywall"),savePaywall:e("#rg_js_savePaywall"),searchPaywallContent:e("#rg_js_searchPaywallContent"),searchPost:e("#rg_js_searchPost"),applyToSelect:e(".rev-gen-preview-main--paywall-actions-apply select"),select2Multiple:e("#rg_js_searchPaywallContent, #rg_js_searchPost"),searchPaywallWrapper:e(".rev-gen-preview-main--paywall-actions-search"),searchPostWrapper:e(".rev-gen-preview-main--paywall-actions-search-post"),paywallName:e(".rev-gen-preview-main-paywall-name"),paywallNameData:e(".rev-gen-preview-main-paywall-name").text().trim(),paywallTitle:".rg-purchase-overlay-title",paywallDesc:".rg-purchase-overlay-description",paywallAppliesTo:".rev-gen-preview-main-paywall-applies-to",currencyOverlay:".rev-gen-preview-main-currency-modal",currencyRadio:".rev-gen-preview-main-currency-modal-inputs-currency",currencyButton:".rev-gen-preview-main-currency-modal-button",currencyModalClose:".rev-gen-preview-main-currency-modal-cross",purchaseOptionWarningWrapper:".rev-gen-preview-main-option-update",purchaseOptionWarningMessage:".rev-gen-preview-main-option-update-message",purchaseOperationContinue:"#rg_js_continueOperation",purchaseOperationCancel:"#rg_js_cancelOperation",newPaywallWarningContinue:"#rg_js_continueSearch",newPaywallWarningCancel:"#rg_js_cancelSearch",purchaseOptionInfoButton:".rg-purchase-overlay-option-info",purchaseOptionInfoModal:".rev-gen-preview-main-info-modal",paywallRemovalModal:".rev-gen-preview-main-remove-paywall",paywallRemove:"#rg_js_removePaywall",paywallCancelRemove:"#rg_js_cancelPaywallRemoval",activationModal:".rev-gen-preview-main-account-modal",activationModalClose:".rev-gen-preview-main-account-modal-cross",connectAccount:"#rg_js_connectAccount",accountSignup:"#rg_js_signUp",activateAccount:"#rg_js_verifyAccount",reVerifyAccount:"#rg_js_restartVerification",accountActionsWrapper:".rev-gen-preview-main-account-modal-action",accountActionsFields:".rev-gen-preview-main-account-modal-fields",accountCredentialsInfo:".rev-gen-preview-main-account-modal-credentials-info",accountActionId:".rev-gen-preview-main-account-modal-fields-merchant-id",accountActionKey:".rev-gen-preview-main-account-modal-fields-merchant-key",accountActionTitle:".rev-gen-preview-main-account-modal-fields-title",accountActions:".rev-gen-preview-main-account-modal-actions",accountVerificationLoader:".rev-gen-preview-main-account-modal-fields-loader",activationModalError:".rev-gen-preview-main-account-modal-error",activationModalSuccess:".rev-gen-preview-main-account-modal-success",activationModalSuccessTitle:".rev-gen-preview-main-account-modal-success-title",activationModalSuccessMessage:".rev-gen-preview-main-account-modal-success-message",activationModalWarningMessage:".rev-gen-preview-main-account-modal-warning-message",activateSignup:"#rg_js_activateSignup",warningSignup:"#rg_js_warningSignup",viewPost:"#rg_js_viewPost",viewDashboard:"#rg_js_viewDashboard",exitTour:".rev-gen-exit-tour",snackBar:e("#rg_js_SnackBar"),emailSupportButton:e(".rev-gen-email-support")},n=function(t,n=0,a="",r=[]){const o={action:"rg_post_permalink",preview_post_id:t,category_id:n,applies_to:a,specific_posts_ids:r,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:o,dataType:"json"}).done((function(e){e.redirect_to&&window.open(e.redirect_to,"_blank")}))},a=function(){if(1===parseInt(revenueGeneratorGlobalOptions.globalOptions.is_merchant_verified)){t.previewWrapper.find(t.activationModal).remove();const e=wp.template("revgen-account-activation-modal");t.previewWrapper.append(e),t.body.addClass("modal-blur"),t.purchaseOverlay.css({filter:"blur(5px)","pointer-events":"none"}),t.actionsWrapper.css({"background-color":"#a9a9a9"}),t.actionButtons.css({opacity:"0.5"}),t.searchContentWrapper.css({"background-color":"#a9a9a9"})}if(!t.requestSent){t.requestSent=!0,f();const n={action:"rg_activate_paywall",paywall_id:e(t.purchaseOptionItems).attr("data-paywall-id"),security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(n){t.requestSent=!1,m();const a=t.postPreviewWrapper.attr("data-preview-id"),r=t.paywallName.text().trim(),o=e(t.paywallAppliesTo).val();let i="";if("category"===o||"exclude_category"===o){const e=t.searchPaywallContent.text().trim();i=x(G("category"===o?"Has been published to <b>all posts</b> in category <b>%s</b>.":"Has been published to <b>all posts, except posts under</b> in category <b>%s</b>.","revenue-generator"),e)}else i="supported"===o?x(G("Has been published on <b>%s</b>.","revenue-generator"),e(t.postTitle).text().trim()):G("specific_post"===o?"Has been published on <b>Specific Posts & Pages</b>.":"Has been published on <b>all posts</b>.","revenue-generator");const s=t.previewWrapper.find(t.activationModal),c=s.find(t.activationModalSuccess);c.find(t.activationModalSuccessTitle).text(r),c.find(t.activationModalSuccessMessage).append(e("<p/>").html(i)),c.find(t.viewPost).attr("data-target-id",a),s.find(t.activationModalError).remove(),s.find(t.accountActionsWrapper).remove(),s.find(t.accountActionsFields).remove(),!0===n.has_paywalls?c.find(t.activationModalWarningMessage).show():c.find(t.activationModalWarningMessage).hide(),c.css({display:"flex"})}))}},r=function(n,r){if(!t.requestSent){t.requestSent=!0;const o={action:"rg_verify_account_credentials",merchant_id:n,merchant_key:r,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};let i="";const s=t.previewWrapper.find(t.activationModal);s.find(t.accountActionTitle).text(G("Just a second...","revenue-generator")),s.find(t.accountActionId).remove(),s.find(t.accountCredentialsInfo).remove(),s.find(t.accountActionKey).remove(),s.find(t.accountActions).remove(),s.find(t.accountVerificationLoader).show(),e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:o,dataType:"json"}).done((function(n){t.requestSent=!1,s.find(t.accountActionsFields).hide();const r=e(t.purchaseOptionItems);if(revenueGeneratorGlobalOptions.merchant_id=n.merchant_id,r&&r.length>0)if(!0===n.success){r.attr("data-paywall-id").length?a():(t.isPublish=!0,t.savePaywall.trigger("click"),f(),setTimeout((function(){revenueGeneratorGlobalOptions.globalOptions.is_merchant_verified="1",a(),m()}),2e3)),i="Success"}else t.isPublish=!0,t.savePaywall.trigger("click"),s.find(t.activationModalError).css({display:"flex"}),i="Failure - "+n.msg;else t.contributionBox&&t.contributionBox.length>0?!0===n.success?(t.isPublish=!0,f(),e(t.activationModalClose).trigger("click"),setTimeout((function(){revenueGeneratorGlobalOptions.globalOptions.is_merchant_verified="1",m(),t.snackBar.showSnackbar(n.msg,1500)}),2e3),i="Success"):(t.isPublish=!0,s.find(t.activationModalError).css({display:"flex"}),i="Failure - "+n.msg):(t.isPublish=!0,s.find(t.activationModalError).css({display:"flex"}),i="Failure - Unknow Error");rgGlobal.sendLPGAEvent("Connect Account","LP RevGen Account",i,0,!0)}))}},o=function(e){tippy(e,{arrow:tippy.roundArrow})},i=function(){const e=t.previewWrapper.find(t.activationModal);e.find(t.accountActionsWrapper).hide(),e.find(t.accountActionsFields).css({display:"flex"})},s=function(){t.previewWrapper.find(t.activationModal).remove();const e=wp.template("revgen-account-activation-modal");t.previewWrapper.append(e),t.body.addClass("modal-blur"),t.purchaseOverlay.css({filter:"blur(5px)","pointer-events":"none"}),t.actionsWrapper.css({"background-color":"#a9a9a9"}),t.actionButtons.css({opacity:"0.5"}),t.searchContentWrapper.css({"background-color":"#a9a9a9"})},l=function(){return new Shepherd.Tour({defaultStepOptions:{classes:"rev-gen-tutorial-card",scrollTo:!0,scrollToHandler:t=>{e("html, body").animate({scrollTop:e(t).offset().top-e(window).height()/2-e(t).height()},1e3)}}})},p=function(t){const n={text:G("Skip Tour","revenue-generator"),action:t.complete,classes:"shepherd-content-skip-tour"},a={text:G("Next >","revenue-generator"),action:t.next,classes:"shepherd-content-next-tour-element"},r="LP RevGen Paywall Tutorial",o=t.addStep({id:"rg-main-search-input",text:G("Search for the page or post you'd like to preview with Revenue Generator here.","revenue-generator"),attachTo:{element:".rev-gen-preview-main--search",on:"bottom"},arrow:!0,classes:"shepherd-content-add-space-top fade-in",buttons:[n,a],when:{hide(){rgGlobal.sendLPGAEvent("1 - Article Search",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=o.options.classes;o.options.classes=e.replace("fade-in","fade-out"),o.updateStepOptions(o.options)}).on("hide",()=>{e(o.el).removeAttr("hidden"),setTimeout((function(){e(o.el).attr("hidden","")}),700)}),i=t.addStep({id:"rg-purchase-overlay-header",text:G("Click to Edit","revenue-generator"),attachTo:{element:".rg-purchase-overlay-title",on:"bottom"},arrow:!0,classes:"rev-gen-tutorial-title fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("2 - Name Paywall",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=i.options.classes;i.options.classes=e.replace("fade-in","fade-out"),i.updateStepOptions(i.options)}).on("hide",()=>{e(i.el).removeAttr("hidden"),setTimeout((function(){e(i.el).attr("hidden","")}),700)}),s=t.addStep({id:"rg-purchase-option-item",text:G("Hover over each element to see the available options.","revenue-generator"),attachTo:{element:".rg-purchase-overlay-purchase-options .option-item-second",on:"top"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("3 - Element Hover",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=s.options.classes;s.options.classes=e.replace("fade-in","fade-out"),s.updateStepOptions(s.options)}).on("hide",()=>{e(s.el).removeAttr("hidden"),setTimeout((function(){e(s.el).attr("hidden","")}),700)}),c=t.addStep({id:"rg-purchase-option-item-edit",text:G("Click on the ‘more options’ icon to set the product type (single item purchase, time pass, or subscription).","revenue-generator"),attachTo:{element:".rg-purchase-overlay-purchase-options .option-item-second .rg-purchase-overlay-option-edit",on:"left"},arrow:!0,buttons:[a],classes:"fade-in",when:{hide(){rgGlobal.sendLPGAEvent("4 - More Options",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=c.options.classes;c.options.classes=e.replace("fade-in","fade-out"),c.updateStepOptions(c.options)}).on("hide",()=>{e(c.el).removeAttr("hidden"),setTimeout((function(){e(c.el).attr("hidden","")}),700)}),l=t.addStep({id:"rg-purchase-option-item-title",text:G("Click on any text element to edit it.","revenue-generator"),attachTo:{element:".rg-purchase-overlay-purchase-options .option-item-second .rg-purchase-overlay-purchase-options-item-info .rg-purchase-overlay-purchase-options-item-info-title",on:"top"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("5 - Text Edit",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=l.options.classes;l.options.classes=e.replace("fade-in","fade-out"),l.updateStepOptions(l.options)}).on("hide",()=>{e(l.el).removeAttr("hidden"),setTimeout((function(){e(l.el).attr("hidden","")}),700)}),p=t.addStep({id:"rg-purchase-option-item-price",text:x(G("These are our recommended prices. %1$s%1$sClick to edit; prices lower than 5.00 will default to %2$spay later%3$s.","revenue-generator"),"<br/>",'<a class="info-link" href="https://www.laterpay.net/academy/getting-started-with-laterpay-the-difference-between-pay-now-pay-later" target="_blank" rel="noopener noreferrer">',"</a>"),attachTo:{element:".rg-purchase-overlay-purchase-options .option-item-second .rg-purchase-overlay-purchase-options-item-price",on:"top"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("6 - Pricing",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=p.options.classes;p.options.classes=e.replace("fade-in","fade-out"),p.updateStepOptions(p.options)}).on("hide",()=>{e(p.el).removeAttr("hidden"),setTimeout((function(){e(p.el).attr("hidden","")}),700)}),u=t.addStep({id:"rg-purchase-option-item-add",text:G("Hover below the paywall to get the option to add another purchase button.","revenue-generator"),attachTo:{element:".rg-purchase-overlay-option-area-add-option",on:"top"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("7 - Add Purchase Option",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=u.options.classes;u.options.classes=e.replace("fade-in","fade-out"),u.updateStepOptions(u.options)}).on("hide",()=>{e(u.el).removeAttr("hidden"),setTimeout((function(){e(u.el).attr("hidden","")}),700)}),d=t.addStep({id:"rg-purchase-option-paywall-name",text:G("Click here to change the name of your paywall.","revenue-generator"),attachTo:{element:".rev-gen-preview-main-paywall-name",on:"bottom"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("8 - Name Paywall",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=d.options.classes;d.options.classes=e.replace("fade-in","fade-out"),d.updateStepOptions(d.options)}).on("hide",()=>{e(d.el).removeAttr("hidden"),setTimeout((function(){e(d.el).attr("hidden","")}),700)}),h=t.addStep({id:"rg-purchase-option-paywall-actions-search",text:G("Select the content that should display this paywall.","revenue-generator"),attachTo:{element:".rev-gen-preview-main--paywall-actions-search",on:"bottom"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("9 - Select Content",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=h.options.classes;h.options.classes=e.replace("fade-in","fade-out"),h.updateStepOptions(h.options)}).on("hide",()=>{e(h.el).removeAttr("hidden"),setTimeout((function(){e(h.el).attr("hidden","")}),700)}),g=t.addStep({id:"rg-purchase-option-paywall-publish",text:G("When you’re ready to activate your paywall, connect your Laterpay account.","revenue-generator"),attachTo:{element:"#rg_js_activatePaywall",on:"bottom"},arrow:!0,classes:"shepherd-content-add-space-bottom fade-in",buttons:[{text:G("Complete","revenue-generator"),action:t.next,classes:"shepherd-content-complete-tour-element"}],when:{hide(){rgGlobal.sendLPGAEvent("10 - Publish",r,"Complete",0,!0)}}}).on("before-hide",()=>{const e=g.options.classes;g.options.classes=e.replace("fade-in","fade-out"),g.updateStepOptions(g.options)}).on("hide",()=>{e(g.el).removeAttr("hidden"),setTimeout((function(){e(g.el).attr("hidden","")}),700)})},u=function(n){e(t.exitTour).css({visibility:"visible","pointer-events":"all",cursor:"pointer"}),t.body.addClass("modal-blur"),t.layoutWrapper.css({"pointer-events":"none"}),e(t.purchaseOptionItem).css({"background-color":"darkgray"}),e(t.purchaseOptionItemInfo).css({"border-right":"1px solid #928d8d"}),t.emailSupportButton.hide();const a=["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],r=function(e){if(a.includes(e.key))return e.preventDefault(),!1};e(document).keydown(r),Shepherd.on("complete",(function(){t.body.removeClass("modal-blur"),t.layoutWrapper.css({"pointer-events":"unset"}),t.searchContentWrapper.css({"background-color":"#fff"}),e(t.purchaseOptionItem).css({"background-color":"#fff"}),e(t.purchaseOptionItemInfo).css({"border-right":"1px solid #e3e4e6"}),e(t.exitTour).remove(),t.emailSupportButton.show(),e(document).unbind("keydown",r);let n="",a="Exit Tour";switch(Shepherd.activeTour.getCurrentStep().id){case"rg-main-search-input":n="1 - Article Search";break;case"rg-purchase-overlay-header":n="2 - Name Paywall";break;case"rg-purchase-option-item":n="3 - Element Hover";break;case"rg-purchase-option-item-edit":n="4 - More Options";break;case"rg-purchase-option-item-title":n="5 - Text Edit";break;case"rg-purchase-option-item-price":n="6 - Pricing";break;case"rg-purchase-option-item-add":n="7 - Add Purchase Option";break;case"rg-purchase-option-paywall-name":n="8 - Name Paywall";break;case"rg-purchase-option-paywall-actions-search":n="9 - Select Content";break;case"rg-purchase-option-paywall-publish":n="10 - Publish",a="Complete"}rgGlobal.sendLPGAEvent(n,"LP RevGen Paywall Tutorial",a,0,!0),setTimeout((function(){d()}),500)})),n.start()},d=function(){const t={action:"rg_complete_tour",config_key:"is_paywall_tutorial_completed",config_value:1,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:t,dataType:"json"}).done((function(e){e.success&&window.location.reload()}))},h=function(n){if(!t.requestSent){t.requestSent=!0;const a={action:"rg_clear_category_meta",rg_category_id:n,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:a,dataType:"json"}).done((function(){t.requestSent=!1}))}},g=function(n){if(!t.requestSent){t.requestSent=!0;const a={action:"rg_select_preview_content",post_preview_id:n,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:a,dataType:"json"}).done((function(e){t.requestSent=!1,e.redirect_to&&(window.location.href=e.redirect_to)}))}},v=function(n){if(n.length&&!t.requestSent){t.requestSent=!0;const a={action:"rg_search_preview_content",search_term:n,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:a,dataType:"json"}).done((function(a){if(t.requestSent=!1,!0===a.success){t.searchContentWrapper.addClass("searching"),t.searchResultWrapper.empty(),a.preview_posts.forEach((function(a){const r="post"===a.type?"dashicons-admin-post":"dashicons-admin-page",o=a.title,i=new RegExp(n,"i"),s=o.replace(i,`<b>${n}</b>`),c=e("<span/>",{"data-id":a.id,class:"rev-gen-preview-main--search-results-item dashicons-before"}).append(s);c.addClass(r),t.searchResultWrapper.append(c),t.searchResultWrapper.css({display:"flex"})}));const r="LP RevGen Paywall Preview",o="";rgGlobal.sendLPGAEvent("Article Search",r,o,0,!0)}else t.snackBar.showSnackbar(a.msg,1500)}))}},f=function(){t.laterpayLoader.css({display:"flex"})},m=function(){t.laterpayLoader.hide()},y=function(){const n={action:"rg_remove_paywall",id:e(t.purchaseOptionItems).attr("data-paywall-id"),security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(n){const a=t.paywallName.text().trim();t.snackBar.showSnackbar(n.msg,1500),t.purchaseOverlay.remove(),t.actionsWrapper.css({width:"75%","background-color":"rgba(239, 239, 239, 0.3)","backdrop-filter":"blur(10px)"});const r=wp.template("revgen-add-paywall");t.actionsWrapper.empty().append(r),n.preview_id&&e(t.addPaywall).attr("data-preview-id",n.preview_id);rgGlobal.sendLPGAEvent("Paywall Deleted","LP RevGen Configure Paywall",a,0,!0)}))},b=async function(){const e=await w();return t.previewWrapper.find(t.paywallRemovalModal).remove(),t.body.removeClass("modal-blur"),t.purchaseOverlay.css({filter:"unset","pointer-events":"unset"}),e},w=function(){return new Promise(n=>{t.previewWrapper.find(t.paywallRemovalModal).remove();const a=wp.template("revgen-remove-paywall");t.previewWrapper.append(a),t.body.addClass("modal-blur"),t.purchaseOverlay.css({filter:"blur(5px)","pointer-events":"none"}),e(t.paywallRemove).off("click"),e(t.paywallCancelRemove).off("click"),e(t.paywallRemove).on("click",()=>{e(t.paywallRemovalModal).hide(),n(!0)}),e(t.paywallCancelRemove).on("click",()=>{e(t.paywallRemovalModal).hide(),n(!1)})})},_=async function(e){const n=await P(e);return t.previewWrapper.find(t.purchaseOptionWarningWrapper).remove(),t.body.removeClass("modal-blur"),t.purchaseOverlay.css({filter:"unset","pointer-events":"unset"}),t.actionsWrapper.css({"background-color":"#fff"}),t.actionButtons.css({opacity:"1"}),t.searchContentWrapper.css({"background-color":"#fff"}),n},P=function(n){return new Promise(a=>{t.previewWrapper.find(t.purchaseOptionWarningWrapper).remove();const r=wp.template("revgen-purchase-option-update");t.previewWrapper.append(r);const o=e(t.purchaseOptionWarningWrapper).find(t.purchaseOptionWarningMessage);o.length&&("timepass"===n?o.empty().text(G("The changes you have made will impact this time pass offer on all paywalls across your entire site.","revenue-generator")):"subscription"===n?o.empty().text(G("The changes you have made will impact this subscription offer on all paywalls across your entire site.","revenue-generator")):"newPurchaseOption"===n&&o.empty().text(G("It looks like you have added a new Global Time Pass or Subscription to this Paywall. Global Time Passes and Subscriptions will show up on all paywalls across your entire site.","revenue-generator"))),t.body.addClass("modal-blur"),t.purchaseOverlay.css({filter:"blur(5px)","pointer-events":"none"}),t.actionsWrapper.css({"background-color":"#a9a9a9"}),t.actionButtons.css({opacity:"0.5"}),t.searchContentWrapper.css({"background-color":"#a9a9a9"}),e(t.purchaseOperationContinue).off("click"),e(t.purchaseOperationCancel).off("click"),e(t.purchaseOperationContinue).on("click",()=>{e(t.purchaseOptionWarningWrapper).hide(),a(!0)}),e(t.purchaseOperationCancel).on("click",()=>{e(t.purchaseOptionWarningWrapper).hide(),a(!1)})})},k=function(n,a,r=!0){const o={action:"rg_remove_purchase_option",type:n,id:a,paywall_id:e(t.purchaseOptionItems).attr("data-paywall-id"),security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:o,dataType:"json"}).done((function(e){!0===r&&t.snackBar.showSnackbar(e.msg,1500)}))},O=function(){const n=e(t.purchaseOptionItems);if(n.length){n.children(t.purchaseOptionItem).each((function(){const n=(100*e(this).find(t.purchaseOptionItemPrice).text().trim()).toFixed(0);e(this).attr("data-lpc-pricing",n)}));const a=n.find("[data-purchase-type='individual']"),r=n.find("[data-purchase-type='timepass']"),o=n.find("[data-purchase-type='subscription']");a.length&&n.prepend(a),r.length&&(r.sort((function(t,n){return+e(t).attr("data-lpc-pricing")-+e(n).attr("data-lpc-pricing")})),n.find("[data-purchase-type='timepass']").remove(),a.length?n.find(a).after(r):n.prepend(r)),o.length&&(o.sort((function(t,n){return+e(t).data("lpc-pricing")-+e(n).data("lpc-pricing")})),n.find("[data-purchase-type='subscription']").remove(),n.append(o)),n.children(t.purchaseOptionItem).each((function(t){const n=t+1;e(this).attr("data-order",n)}))}},S=function(n,a){const r=e(a).find(".rg-purchase-overlay-option-manager"),o=r.find(t.purchaseRevenueWrapper),i=r.find(t.individualPricingWrapper),s=e(a).attr("data-purchase-type");e(a).attr("data-pricing-type","static"),i.find(t.individualPricingSelection).prop("checked",!1),n>=revenueGeneratorGlobalOptions.currency.sis_only_limit?(e(a).find(t.purchaseOptionItemPrice).attr("data-pay-model","sis"),o.find(t.purchaseRevenueSelection).prop("checked",!1),"subscription"!==s&&(e(a).trigger("mouseenter"),e(a).find(t.editOption).trigger("click"))):(n<=revenueGeneratorGlobalOptions.currency.ppu_min||n>revenueGeneratorGlobalOptions.currency.ppu_min)&&n<revenueGeneratorGlobalOptions.currency.sis_min&&(e(a).find(t.purchaseOptionItemPrice).attr("data-pay-model","ppu"),o.find(t.purchaseRevenueSelection).prop("checked",!0),"subscription"!==s&&(e(a).trigger("mouseenter"),e(a).find(t.editOption).trigger("click")))},A=function(n,a){const r=e(n).find(t.purchaseOptionItemPrice),o=parseFloat(r.text().trim()),i=e(n).attr("data-purchase-type"),s=revenueGeneratorGlobalOptions.currency;let c=T(o);if(!1===a&&o<=parseFloat(s.ppu_only_limit))if(c=T(s.sis_min,"subscription"===i),t.snackBar.showSnackbar(G("Pay Now is only available for prices set to $1.99 or higher.","revenue-generator"),2500),"individual"===i){e(t.purchaseItemPriceIcon).css({display:"none"}),r.text(c)}else r.empty().text(c);else if(!0===a&&o>parseFloat(s.ppu_max))if(c=T(s.ppu_max,"subscription"===i),t.snackBar.showSnackbar(G("Pay Later is only available for prices set less than $5.","revenue-generator"),2500),"individual"===i){e(t.purchaseItemPriceIcon).css({display:"none"}),r.text(c)}else r.empty().text(c)},T=function(e,t){return"number"!=typeof e&&(e=e.replace(/[^0-9\,\.]/g,""),e=parseFloat(e.replace(",",".")).toFixed(2)),isNaN(e)&&(e=0),e=Math.abs(e),t?e<revenueGeneratorGlobalOptions.currency.sis_min?e=revenueGeneratorGlobalOptions.currency.sis_min:e>revenueGeneratorGlobalOptions.currency.sis_max&&(e=revenueGeneratorGlobalOptions.currency.sis_max):(e>revenueGeneratorGlobalOptions.currency.sis_max&&(e=revenueGeneratorGlobalOptions.currency.sis_max),e>0&&e<revenueGeneratorGlobalOptions.currency.ppu_min&&(e=revenueGeneratorGlobalOptions.currency.ppu_min)),e=e.toFixed(2),-1!==revenueGeneratorGlobalOptions.locale.indexOf("de_DE")&&(e=e.replace(".",",")),e},I=function(){t.previewWrapper.find(t.currencyOverlay).remove();const e=wp.template("revgen-purchase-currency-overlay");t.previewWrapper.append(e),t.body.addClass("modal-blur"),t.purchaseOverlay.css({filter:"blur(5px)","pointer-events":"none"})},W=function(n,a){e.ajax({url:n,method:"POST",data:a,dataType:"json"}).done((function(n){m(),t.snackBar.showSnackbar(n.msg,1500),e(t.purchaseOptionItems).find(t.purchaseOptionItem).length<5&&e(t.optionArea).show();let r="",o="";o=t.isPublish?"Publish":"Save";const i="LP RevGen Paywall Publish",s=a.paywall.name;let c=revenueGeneratorGlobalOptions.merchant_id;!c&&e(t.accountActionId).val()&&(c=e(t.accountActionId).val());const l=a.paywall.applies,p=a.post_id,u=a.subscriptions.length,d=a.time_passes.length,h=parseInt(u)+parseInt(d);r=c+" - "+n.paywall_id+" - "+s+" - "+l+" - "+p+" - "+h,rgGlobal.sendLPGAEvent(o,i,r,0,!0);const g=e(t.purchaseOptionItems);o="Paywall Details",g.attr("data-paywall-id",n.paywall_id);const v=g.find("[data-purchase-type='individual']");if(v.length){v.attr("data-paywall-id",n.paywall_id);let e=a.individual.type;if("dynamic"!==e){const t=a.individual.revenue;"ppu"===t?e="Pay Later":"sis"===t&&(e="Pay now")}const t=a.individual.price;r=revenueGeneratorGlobalOptions.merchant_id+" - "+n.paywall_id+" - Single Article - "+e+" - "+t,rgGlobal.sendLPGAEvent(o,i,r,0,!0)}const f=g.find("[data-purchase-type='timepass']");f.length&&f.each((function(t){const s=e(this).attr("data-uid");e(this).attr("data-tlp-id",n.time_passes[s]);const c=a.time_passes[t].revenue;let l="";"ppu"===c?l="Pay Later":"sis"===c&&(l="Pay now");const p=a.time_passes[t].price,u=a.time_passes[t].period+a.time_passes[t].duration;r=revenueGeneratorGlobalOptions.merchant_id+" - "+n.paywall_id+" - Time Pass - "+l+" - "+u+" - "+p,rgGlobal.sendLPGAEvent(o,i,r,0,!0)}));const y=g.find("[data-purchase-type='subscription']");y.length&&y.each((function(t){const s=e(this).attr("data-uid");e(this).attr("data-sub-id",n.subscriptions[s]);const c=a.subscriptions[t].revenue;let l="";"ppu"===c?l="Pay Later":"sis"===c&&(l="Pay now");const p=a.subscriptions[t].price,u=a.subscriptions[t].period+a.subscriptions[t].duration;r=revenueGeneratorGlobalOptions.merchant_id+" - "+n.paywall_id+" - Subscription - "+l+" - "+u+" - "+p,rgGlobal.sendLPGAEvent(o,i,r,0,!0)})),n.redirect_to&&!1===t.isPublish&&(window.location.href=n.redirect_to)}))},j=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},L=function(t,n){const a=[];let r=24;"y"===t?r=1:"m"===t&&(r=12);for(let t=1;t<=r;t++){const n=e("<option/>",{value:t});n.text(t),a.push(n)}e(n).find("option").remove().end().append(a)};e(document).ready((function(){t.postPreviewWrapper.fadeIn("slow"),t.applyToSelect.select2({width:"auto",dropdownAutoWidth:!0,dropdownCssClass:":all:"}),e(t.noResultsWrapper).length&&(t.layoutWrapper.css({"background-color":"rgba(0, 0, 0, 0.5)","min-height":"800px"}),t.searchContentWrapper.css({"background-color":"#fff"}),tippy(document.querySelector(".rev-gen-preview-main--search"),{arrow:tippy.roundArrow}).show()),e(t.paywallAppliesTo).trigger("change");const n=e(t.purchaseOptionItems);if(n.length){const e=n.find("[data-purchase-type='individual']");"dynamic"===e.attr("data-pricing-type")&&(e.find(t.purchaseItemPriceIcon).show(),o(".rg-purchase-overlay-purchase-options-item-price-icon"))}if(revenueGeneratorGlobalOptions.globalOptions.average_post_publish_count.length&&0===parseInt(revenueGeneratorGlobalOptions.globalOptions.is_paywall_tutorial_completed)&&n&&n.length>0){const e=l();p(e),u(e)}const a=t.select2Multiple.val();if(a&&a.length>0){const t=e(".select2-selection--multiple .select2-search.select2-search--inline");t.trigger("click"),t.trigger("click")}})),t.body.on("click",t.purchaseOptionItemTitle,(function(){this.addEventListener("input",(function(){e(this).closest(t.purchaseOptionItem).attr("data-custom-title","1")}))})),t.body.on("click",t.purchaseOptionItemDesc,(function(){this.addEventListener("input",(function(){e(this).closest(t.purchaseOptionItem).attr("data-custom-desc","1")}))})),t.body.on("change",t.periodCountSelection+", "+t.periodSelection,(function(){const n=e(this);f(),setTimeout((function(){const e=parseInt(n.closest(t.purchaseOptionItem).find(t.periodCountSelection).val()),a=n.closest(t.purchaseOptionItem).find(t.periodSelection).val(),r=n.closest(t.purchaseOptionItem).data("purchase-type");new C({id:"rg-modal-dynamic-title-desc",onConfirm:async()=>{let o;switch(o=e,a){case"h":o+=G(" Hour","revenue-generator");break;case"d":o+=G(" Day","revenue-generator");break;case"w":o+=G(" Week","revenue-generator");break;case"m":o+=G(" Month","revenue-generator");break;case"y":o+=G(" Year","revenue-generator")}let i=x(G("Enjoy unlimited access to all our content for %1$s"),o);switch(e&&e>1&&(i=x(G("Enjoy unlimited access to all our content for %1$ss"),o)),r){case"subscription":o+=G(" Subscription","revenue-generator");break;case"timepass":o+=G(" Pass","revenue-generator")}n.closest(t.purchaseOptionItem).find(t.purchaseOptionItemTitle).text(o),n.closest(t.purchaseOptionItem).find(t.purchaseOptionItemDesc).text(i)},onCancel:()=>{}}),m()}),1e3)})),t.body.on("click",".shepherd-button",(function(){const n=Shepherd.activeTour.getCurrentStep().id;e(t.purchaseOptionItem).css({"background-color":"darkgray"}),e(t.purchaseOptionItemInfo).css({"border-right":"1px solid #928d8d"}),"rg-purchase-option-item"===n?(e(t.previewSecondItem).trigger("mouseenter"),t.searchContentWrapper.css({"background-color":"#a9a9a9"}),e(t.previewSecondItem).css({"background-color":"#fff"}),e(t.previewSecondItem).find(t.purchaseOptionItemInfo).css({"border-right":"1px solid #e3e4e6"})):"rg-purchase-option-item-price"===n?e(t.previewSecondItem).trigger("mouseleave"):"rg-purchase-option-paywall-name"===n?(e(t.paywallAppliesTo).val("category"),e(t.paywallAppliesTo).trigger("change")):"rg-purchase-option-paywall-publish"===n&&t.activatePaywall.css("background-color","#000")})),t.body.on("click",t.exitTour,(function(){"undefined"!=typeof Shepherd&&void 0!==Shepherd.activeTour&&Shepherd.activeTour.complete()})),t.postPreviewWrapper.on("click",(function(){t.searchContentWrapper.removeClass("searching"),t.searchResultWrapper.hide(),t.searchContentWrapper.find("label").show();const n=t.searchContent.val().trim(),a=e(t.postTitle).text().trim();n!==a&&t.searchContent.val(a)})),t.body.on("click",t.searchResultItem,(function(){const t=e(this).attr("data-id");g(t)})),t.searchContent.on("focus",(function(){t.postPreviewWrapper.addClass("blury"),e("html, body").animate({scrollTop:0},"slow"),t.body.css({overflow:"hidden",height:"100%"})})),t.searchContent.on("click",(function(){return!!t.currentPaywall.val()&&new Promise(n=>{const a=wp.template("revgen-new-paywall-warning");t.previewWrapper.append(a),t.body.addClass("modal-blur"),t.actionsWrapper.css("background-color","#a9a9a9"),t.layoutWrapper.css({"pointer-events":"unset"}),t.body.find("input, select, button").not("#rg_js_searchContent,"+t.newPaywallWarningContinue+","+t.newPaywallWarningCancel).addClass("input-blur"),e(t.newPaywallWarningContinue).off("click"),e(t.newPaywallWarningCancel).off("click"),e(t.newPaywallWarningContinue).on("click",()=>{t.postPreviewWrapper.addClass("blury"),e("html, body").animate({scrollTop:0},"slow"),t.body.css({overflow:"hidden",height:"100%"}),t.body.removeClass("modal-blur"),t.body.find("input, select, button").removeClass("input-blur"),t.layoutWrapper.css({"pointer-events":"unset"}),t.actionsWrapper.css("background-color","#fff"),e(".search-paywall-warning-modal").remove(),e(this).focus(),n(!0)}),e(t.newPaywallWarningCancel).on("click",()=>{t.body.removeClass("modal-blur"),t.body.find("input, select, button").removeClass("input-blur"),t.actionsWrapper.css("background-color","#fff"),t.layoutWrapper.css({"pointer-events":"unset"}),e(".search-paywall-warning-modal").remove(),n(!1)})})})),t.searchContent.on("focusout",(function(){t.body.css({overflow:"auto",height:"auto"}),t.postPreviewWrapper.removeClass("blury")})),t.searchContent.on("input change",Object(c.a)((function(){t.searchContentWrapper.find("label").hide();const n=e(this).val().trim(),a=e(t.postTitle).text().trim();n.length&&n!==a&&v(n)}),500)),t.searchPaywallContent.select2({ajax:{url:revenueGeneratorGlobalOptions.ajaxUrl,dataType:"json",delay:500,type:"POST",data:e=>({term:e.term,action:"rg_search_term",security:revenueGeneratorGlobalOptions.rg_paywall_nonce}),processResults(t){const n=[];return t&&e.each(t.categories,(function(e){const a=t.categories[e];n.push({id:a.term_id,text:a.name})})),{results:n}},cache:!0},width:"auto",dropdownAutoWidth:!0,dropdownCssClass:":all:",placeholder:G("Search","revenue-generator"),language:{inputTooShort:()=>G("Please enter 1 or more characters.","revenue-generator"),noResults:()=>G("No results found.","revenue-generator")},minimumInputLength:1,closeOnSelect:!1}),t.searchPaywallContent.on("change",(function(){const n=e(this).val(),a=JSON.stringify(n);a&&h(a),a&&(t.postPreviewWrapper.attr("data-access-id",a),t.savePaywall.removeAttr("disabled"),t.activatePaywall.removeAttr("disabled"))})),t.searchPost.select2({ajax:{url:revenueGeneratorGlobalOptions.ajaxUrl,dataType:"json",delay:500,type:"POST",data:e=>({term:e.term,action:"rg_search_post",security:revenueGeneratorGlobalOptions.rg_paywall_nonce}),processResults(t){const n=[];return t&&e.each(t.posts,(function(e){const a=t.posts[e];n.push({id:a.ID,text:a.post_title})})),{results:n}},cache:!0},dropdownAutoWidth:!0,dropdownCssClass:":all:",placeholder:G("search","revenue-generator"),language:{inputTooShort:()=>G("Please enter 1 or more characters.","revenue-generator"),noResults:()=>G("No results found.","revenue-generator")},minimumInputLength:1,closeOnSelect:!1}),t.select2Multiple.on("select2:close",(function(){const t=e(this).siblings("span.select2").find(".select2-selection--multiple"),n=e(this).select2("data").length,a=t.find(".select2-selection__rendered .select2-search--inline input");a.attr("placeholder",n+" items selected"),a.css("width","100%")})),t.searchPost.on("change",(function(){const n=e(this).val(),a=JSON.stringify(n);n&&(t.searchPostWrapper.attr("data-access-id",a),t.savePaywall.removeAttr("disabled"),t.activatePaywall.removeAttr("disabled"))})),t.previewWrapper.on("click",(function(n){const a=e(n.target),r=a.parent(".rg-purchase-overlay-option-edit").length;a.parents(".rg-purchase-overlay-option-manager").length||e(t.purchaseOptionInfoModal).length||r||t.body.find(".rg-purchase-overlay-option-manager").hide(),a.parents(".rg-purchase-overlay-option-manager").length||(e(".pricing-info-modal").length&&t.body.find("#pricing-info-modal").trigger("click"),e(".revenue-info-modal").length&&t.body.find("#revenue-info-modal").trigger("click"))})),t.body.on("mouseenter",t.purchaseOptionItem,(function(){t.purchaseOverlay.children(".rg-purchase-overlay-highlight").hide(),e(t.purchaseOverlayRemove).hide();const n=e(this).find(".rg-purchase-overlay-purchase-options-item-actions"),a=n.length,r=e(this).children(".rg-purchase-overlay-purchase-options-item-highlight");if(a)n.show(),e(r).show();else{const t=wp.template("revgen-purchase-overlay-actions")();e(r).show(),e(this).prepend(t)}})),t.body.on("mouseleave",t.purchaseOptionItem,(function(){e(this).children(".rg-purchase-overlay-purchase-options-item-highlight").hide(),t.body.find(".rg-purchase-overlay-option-manager:visible").length||e(this).find(".rg-purchase-overlay-purchase-options-item-actions").hide()})),t.body.on("click",t.editOption,(function(){const n=e(this).parents(".rg-purchase-overlay-purchase-options-item");let a=n.find(".rg-purchase-overlay-option-manager");const r=e(this).children(".rg-purchase-overlay-purchase-options-item-highlight"),o=e(t.purchaseOptionItems);let i=!1;if(o.children(t.purchaseOptionItem).each((function(){"individual"===e(this).attr("data-purchase-type")&&(i=!0)})),a.length)i&&a.find(".rg-purchase-overlay-option-manager-entity").find("option").filter("[value=individual]").attr("disabled",!0),a.toggle(),r.show();else{const r=n.attr("data-purchase-type"),o={entityType:r},s=wp.template("revgen-purchase-overlay-item-manager")(o);n.prepend(s),a=n.find(".rg-purchase-overlay-option-manager");const c=a.find(".rg-purchase-overlay-option-manager-entity");e(".rg-purchase-overlay-option-manager div").css({"border-bottom-color":"#e3e4e6"}),e(".rg-purchase-overlay-option-manager select").css({"border-color":"#e3e4e6"});const l=a.find(t.durationWrapper);if("individual"!==r)a.find(t.individualPricingWrapper).hide(),l.find(t.periodSelection).val(n.attr("data-expiry-duration")),l.find(t.periodCountSelection).val(n.attr("data-expiry-period")),l.show(),i&&c.find("option").filter("[value=individual]").attr("disabled",!0);else{l.hide();const e=n.attr("data-pricing-type"),r=a.find(t.individualPricingWrapper);"dynamic"===e?(r.find(t.individualPricingSelection).prop("checked",!0),r.find(".static-pricing").addClass("unchecked")):(r.find(t.individualPricingSelection).prop("checked",!1),r.find(".dynamic-pricing").addClass("unchecked"))}const p=a.find(t.purchaseRevenueWrapper);"subscription"===r?(a.find("div").css({height:" 55px"}),p.hide()):("ppu"===n.find(t.purchaseOptionItemPrice).attr("data-pay-model")?(p.find(t.purchaseRevenueSelection).prop("checked",!0),p.find(".pay-now").addClass("unchecked")):(p.find(t.purchaseRevenueSelection).prop("checked",!1),p.find(".pay-later").addClass("unchecked")),p.show())}e(".rev-gen__select2",a).each((function(){e(this).select2({width:"auto",dropdownAutoWidth:!0,dropdownParent:e(this).parent(),dropdownCssClass:":all:",minimumResultsForSearch:-1})}));const s=a.css("display"),c=n.find(".rg-purchase-overlay-purchase-options-item-actions");t.body.find(".rg-purchase-overlay-option-manager").hide(),t.body.find(".rg-purchase-overlay-purchase-options-item-actions").hide(),c.show(),a.css({display:s})})),t.body.on("click",t.optionRemove,(function(){const n=e(this).parents(".rg-purchase-overlay-purchase-options-item"),a=n.attr("data-purchase-type");let r;"individual"===a?r=n.attr("data-paywall-id"):"timepass"===a?r=n.attr("data-tlp-id"):"subscription"===a&&(r=n.attr("data-sub-id")),"individual"!==a&&r?_(a).then(e=>{!0===e&&(n.remove(),O(),k(a,r),t.isPublish=!0,t.savePaywall.trigger("click"))}):(n.remove(),O(),k(a,r),t.isPublish=!0,t.savePaywall.trigger("click"))})),t.body.on("change",t.purchaseOptionType,(function(){const n=e(this).parents(".rg-purchase-overlay-option-manager"),a=n.find(".rg-purchase-overlay-option-manager-entity"),r=n.find(t.individualPricingWrapper),o=n.find(t.purchaseRevenueWrapper),i=n.find(t.durationWrapper);"individual"===a.val()?(r.show(),i.hide()):(r.hide(),i.show()),"subscription"===a.val()?o.hide():o.show()})),t.body.on("change",t.individualPricingSelection,(function(){const n=e(this).parents(t.purchaseOptionItem),a=e(this).parents(".rg-purchase-overlay-option-manager"),r=a.find(t.individualPricingSelection),o=a.find(t.individualPricingWrapper);if(r.prop("checked")){const a=e(t.purchaseOptionItems),i=a.attr("data-dynamic-price"),s=a.attr("data-dynamic-revenue"),c=n.find(t.purchaseOptionItemPrice);c.attr("data-pay-model",s);const l=e(t.purchaseItemPriceIcon),p=T(i);l.css({display:"none"}),c.text(p),n.attr("data-pricing-type","dynamic"),n.find(t.purchaseItemPriceIcon).show(),r.val(1),o.find(".static-pricing").addClass("unchecked"),o.find(".dynamic-pricing").removeClass("unchecked")}else n.attr("data-pricing-type","static"),n.find(t.purchaseItemPriceIcon).hide(),r.val(0),o.find(".static-pricing").removeClass("unchecked"),o.find(".dynamic-pricing").addClass("unchecked")})),t.body.on("change",t.purchaseRevenueSelection,(function(){const n=e(this).parents(t.purchaseOptionItem),a=e(this).parents(".rg-purchase-overlay-option-manager"),r=a.find(t.purchaseRevenueSelection),o=n.find(t.purchaseOptionItemPrice),i=o.attr("data-pay-model"),s=r.val(),c=n.attr("data-purchase-type"),l=a.find(t.purchaseRevenueWrapper);let p;switch(c){case"individual":p=n.attr("data-paywall-id");break;case"timepass":p=n.attr("data-tlp-id");break;case"subscription":p=n.attr("data-sub-id")}if("individual"!==c&&p)_(c).then(e=>{!0===e?r.prop("checked")?(o.attr("data-pay-model","ppu"),r.val(1),A(n,!0),l.find(".pay-later").removeClass("unchecked"),l.find(".pay-now").addClass("unchecked")):(o.attr("data-pay-model","sis"),r.val(0),A(n,!1),l.find(".pay-later").addClass("unchecked"),l.find(".pay-now").removeClass("unchecked")):(o.attr("data-pay-model",i),r.val(s),r.attr("checked",1===parseInt(s)),A(n,1===parseInt(s)),1===parseInt(s)?(l.find(".pay-later").removeClass("unchecked"),l.find(".pay-now").addClass("unchecked")):(l.find(".pay-later").addClass("unchecked"),l.find(".pay-now").removeClass("unchecked")))});else if(r.prop("checked")){o.attr("data-pay-model","ppu"),r.val(1);const a=G("You'll only be charged once you've reached $5.","revenue-generator");e(n).find(t.purchaseOptionItemDesc).text(a),A(n,!0),l.find(".pay-later").removeClass("unchecked"),l.find(".pay-now").addClass("unchecked")}else{o.attr("data-pay-model","sis"),r.val(0);const a=t.searchContent.val(),i=x(G("Get lifetime access to %1$s now!","revenue-generator"),a);e(n).find(t.purchaseOptionItemDesc).text(i),A(n,!1),l.find(".pay-later").addClass("unchecked"),l.find(".pay-now").removeClass("unchecked")}})),t.body.on("change",t.periodSelection,(function(){const n=e(this).parents(".rg-purchase-overlay-option-manager"),a=n.find(t.periodSelection),r=n.find(t.periodCountSelection);L(a.val(),r),e(this).parents(t.purchaseOptionItem).attr("data-expiry-duration",a.val())})),t.body.on("change",t.periodCountSelection,(function(){const n=e(this).parents(".rg-purchase-overlay-option-manager").find(t.periodCountSelection);e(this).parents(t.purchaseOptionItem).attr("data-expiry-period",n.val())})),t.body.on("focus",t.purchaseOptionItemPrice,(function(){const t=e(this).text().trim();e(this).attr("data-current-value",t)})).on("input change",t.purchaseOptionItemPrice,Object(c.a)((function(){const n=e(this).parents(t.purchaseOptionItem),a=n.find(t.purchaseOptionItemPrice),r=e(this).attr("data-current-value"),o=a.text().trim(),i=n.find(t.purchaseOptionPriceSymbol),s=n.attr("data-purchase-type"),c=a.attr("data-pay-model");let l;switch(i.text().trim().length||revenueGeneratorGlobalOptions.globalOptions.merchant_currency.length||I(),s){case"individual":l=n.attr("data-paywall-id");break;case"timepass":l=n.attr("data-tlp-id");break;case"subscription":l=n.attr("data-sub-id")}if("individual"!==s&&l)_(s).then(t=>{if(!0===t){const t=T(o,"subscription"===s);e(this).empty().text(t),S(t,n)}else{const t=T(r,"subscription"===s);e(this).empty().text(t),S(t,n)}});else{const a=T(o,"subscription"===s);e(t.purchaseItemPriceIcon).css({display:"none"}),e(this).text(a),S(a,n)}c!==a.attr("data-pay-model")&&("ppu"===a.attr("data-pay-model")?t.snackBar.showSnackbar(G("Pay Now is only available for prices set to $1.99 or higher.","revenue-generator"),2500):t.snackBar.showSnackbar(G("Pay Later is only available for prices set less than $5.","revenue-generator"),2500)),O()}),1e3)),t.body.on("change",t.currencyRadio,(function(){e(this).val().length&&e(t.currencyOverlay).find(t.currencyButton).removeProp("disabled")})),t.body.on("change",t.paywallAppliesTo,(function(){if("exclude_category"===e(this).val()||"category"===e(this).val()){t.searchPostWrapper.hide(),t.searchPaywallWrapper.show(),t.searchPaywallContent.length&&null===t.searchPaywallContent.val()&&(t.savePaywall.attr("disabled",!0),t.activatePaywall.attr("disabled",!0));const e=JSON.stringify(t.searchPaywallContent.val());t.postPreviewWrapper.attr("data-access-id",e)}else"specific_post"===e(this).val()?(t.searchPaywallWrapper.hide(),t.searchPostWrapper.show(),t.searchPost.length&&null===t.searchPost.val()&&(t.savePaywall.attr("disabled",!0),t.activatePaywall.attr("disabled",!0))):(t.savePaywall.removeAttr("disabled"),t.activatePaywall.removeAttr("disabled"),t.searchPaywallWrapper.hide(),t.searchPostWrapper.hide(),t.postPreviewWrapper.attr("data-access-id",t.postPreviewWrapper.attr("data-preview-id")))})),t.body.on("click",t.currencyButton,(function(){const n={action:"rg_update_currency_selection",config_key:"merchant_currency",config_value:e("input:radio[name=currency]:checked").val(),security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(a){e(t.currencyModalClose).trigger("click"),t.snackBar.showSnackbar(a.msg,1500),e(t.purchaseOptionItems).children(t.purchaseOptionItem).each((function(){const a=e(this).find(t.purchaseOptionPriceSymbol),r="USD"===n.config_value?"$":"€";a.empty().text(r)}))}))})),t.body.on("click",t.currencyModalClose,(function(){t.previewWrapper.find(t.currencyOverlay).remove(),t.body.removeClass("modal-blur"),t.purchaseOverlay.css({filter:"unset","pointer-events":"unset"})})),t.body.on("click",t.addOptionArea,(function(){const n=e(t.purchaseOptionItems).find(t.purchaseOptionItem).length;if(n<5){const n=wp.template("revgen-default-purchase-option-item");e(t.purchaseOptionItems).append(n)}5<=n+parseInt(1)&&e(t.optionArea).hide(),O()})),t.body.on("click",t.purchaseOptionInfoButton,(function(){const n=e(this).attr("data-info-for"),a=t.previewWrapper.find(t.purchaseOptionInfoModal);if(a.length)t.body.removeClass("modal-blur"),a.remove(),e(t.optionManager).css({"background-color":"#fff"}),e(".rg-purchase-overlay-option-manager div").css({"border-bottom-color":"#a9a9a9"}),e(t.optionManager).find("select").css({"background-color":"#fff","border-bottom-color":"#a9a9a9"}),e(t.purchaseOptionItem).css({"background-color":"#fff"}),e(t.optionManager).removeClass("border-blur-after"),t.actionsWrapper.css({"background-color":"#fff"}),t.actionButtons.css({opacity:"1"}),t.searchContentWrapper.css({"background-color":"#fff"}),e(t.purchaseRevenueWrapper).css({"background-color":"#fff","border-bottom-color":"unset !important"}),e(t.individualPricingWrapper).css({"background-color":"#fff","border-color":"unset !important"});else{const a=wp.template(`revgen-info-${n}`);t.previewWrapper.append(a),t.body.addClass("modal-blur"),e(t.optionManager).css({"background-color":"#a9a9a9"}),e(".rg-purchase-overlay-option-manager div").css({"border-bottom-color":"#000"}),e(t.optionManager).find("select").css({"background-color":"#a9a9a9","border-color":"#a9a9a9"}),e(t.purchaseOptionItem).css({"background-color":"#a9a9a9"}),e(t.optionManager).addClass("border-blur-after"),t.actionsWrapper.css({"background-color":"#a9a9a9"}),t.actionButtons.css({opacity:"0.5"}),t.searchContentWrapper.css({"background-color":"#a9a9a9"}),"revenue"===n?(e(t.purchaseRevenueWrapper).css({"background-color":"#fff",cursor:"pointer","pointer-events":"all"}),e(t.individualPricingWrapper).css({"background-color":"#a9a9a9"})):(e(t.individualPricingWrapper).css({"background-color":"#fff",cursor:"pointer","pointer-events":"all"}),e(t.purchaseRevenueWrapper).css({"background-color":"#a9a9a9"}));let r="";"revenue"===n?r="Pay Now v Pay Later":"pricing"===n&&(r="Static Pricing v Dynamic Pricing");const o="LP RevGen Configure Paywall",i="Help";rgGlobal.sendLPGAEvent(i,o,r,0,!0)}})),t.purchaseOverlay.on("mouseenter",(function(){e(t.purchaseOptionItems).attr("data-paywall-id").length&&(t.purchaseOverlay.children(".rg-purchase-overlay-highlight").show(),e(t.purchaseOverlayRemove).show())})),t.purchaseOverlay.on("mouseleave",(function(){t.purchaseOverlay.children(".rg-purchase-overlay-highlight").hide(),e(t.purchaseOverlayRemove).hide()})),t.body.on("click",t.purchaseOverlayRemove,(function(){b().then(e=>{!0===e&&y()})})),t.body.on("click",t.addPaywall,(function(){const n=e(t.addPaywall).attr("data-preview-id");n&&g(n)})),t.body.on("click",t.gotoDashboard,(function(){const t=e(this).attr("data-dashboard-url");t&&(window.location.href=t)})),t.paywallName.on("keydown",(function(t){if(20<=e(this).text().trim().length)switch(t.keyCode){case 8:case 9:case 13:case 37:case 38:case 39:case 40:break;default:const e=new RegExp("^[a-zA-Z0-9.,/ $@()]+$"),n=t.key;if(e.test(n))return t.preventDefault(),!1}})),t.paywallName.on("focusout",(function(){if(t.paywallNameData!==e(this).text().trim()){const n="LP RevGen Configure Paywall",a="Edit Title",r=e(this).text().trim()+" - "+e(t.paywallTitle).text().trim();rgGlobal.sendLPGAEvent(a,n,r,0,!0),t.paywallNameData=e(this).text().trim()}})),t.body.on("change",t.entitySelection,(function(){const n=e(this).parents(t.purchaseOptionItem),a=n.attr("data-purchase-type"),r=e(this).val(),o=n.find(".rg-purchase-overlay-option-manager");let i;if(a!==r)if("subscription"===a?i=n.attr("data-sub-id"):"timepass"===a?i=n.attr("data-tlp-id"):"individual"===a&&(i=n.attr("data-paywall-id")),"individual"!==a&&i&&_(a).then(r=>{if(!0!==r)return n.attr("data-purchase-type",a),e(this).val(a),!1;k(a,i,!1),t.isPublish=!0,t.savePaywall.trigger("click")}),n.removeAttr("data-purchase-type"),n.removeAttr("data-expiry-duration"),n.removeAttr("data-expiry-period"),n.removeAttr("data-pricing-type"),n.removeAttr("data-paywall-id"),n.removeAttr("data-tlp-id"),n.removeAttr("data-sub-id"),n.removeAttr("data-uid"),n.removeAttr("data-order"),n.attr("data-order",""),n.attr("data-uid",""),n.attr("data-purchase-type",r),e(this).val(r),"individual"!==r){const e=n.find(t.purchaseOptionItemPrice);if(e.removeAttr("data-pay-model"),"timepass"===r){const a=revenueGeneratorGlobalOptions.defaultConfig.timepass;n.attr("data-tlp-id",""),n.attr("data-expiry-duration",a.duration),n.attr("data-expiry-period",a.period),e.attr("data-pay-model",a.revenue),e.text(a.price),n.find(t.purchaseOptionItemTitle).text(a.title),n.find(t.purchaseOptionItemDesc).text(a.description),o.find("div").css({height:" 45px"})}else if("subscription"===r){const a=revenueGeneratorGlobalOptions.defaultConfig.subscription;n.attr("data-sub-id",""),n.attr("data-expiry-duration",a.duration),n.attr("data-expiry-period",a.period),e.attr("data-pay-model",a.revenue),e.text(a.price),n.find(t.purchaseOptionItemTitle).text(a.title),n.find(t.purchaseOptionItemDesc).text(a.description),o.find("div").css({height:" 55px"})}}else n.attr("data-pricing-type","static"),n.attr("data-paywall-id",""),o.find("div").css({height:" 45px"})})),t.savePaywall.on("click",(function(){f(),O();const n=e(t.purchaseOptionItems);n.children(t.purchaseOptionItem).each((function(){e(this).attr("data-uid")||e(this).attr("data-uid",j())}));const a=n.find("[data-purchase-type='individual']");let r;a.length&&(r={title:a.find(t.purchaseOptionItemTitle).text().trim(),desc:a.find(t.purchaseOptionItemDesc).text().trim(),price:a.find(t.purchaseOptionItemPrice).text().trim(),revenue:a.find(t.purchaseOptionItemPrice).attr("data-pay-model"),type:a.attr("data-pricing-type"),order:a.attr("data-order")});const o=n.find("[data-purchase-type='timepass']"),i=[];o.each((function(){const n=e(this),a={title:n.find(t.purchaseOptionItemTitle).text().trim(),desc:n.find(t.purchaseOptionItemDesc).text().trim(),price:n.find(t.purchaseOptionItemPrice).text().trim(),revenue:e(n.find(t.purchaseOptionItemPrice)).attr("data-pay-model"),duration:e(n).attr("data-expiry-duration"),period:e(n).attr("data-expiry-period"),tlp_id:e(n).attr("data-tlp-id"),uid:e(n).attr("data-uid"),order:e(n).attr("data-order")};i.push(a)}));const s=n.find("[data-purchase-type='subscription']"),c=[];s.each((function(){const n=e(this),a={title:n.find(t.purchaseOptionItemTitle).text().trim(),desc:n.find(t.purchaseOptionItemDesc).text().trim(),price:n.find(t.purchaseOptionItemPrice).text().trim(),revenue:e(n.find(t.purchaseOptionItemPrice)).attr("data-pay-model"),duration:e(n).attr("data-expiry-duration"),period:e(n).attr("data-expiry-period"),sub_id:e(n).attr("data-sub-id"),uid:e(n).attr("data-uid"),order:e(n).attr("data-order")};c.push(a)}));const l=t.searchPost.val();let p="";l&&(p=JSON.stringify(l));const u={id:n.attr("data-paywall-id"),title:t.purchaseOverlay.find(t.paywallTitle).text().trim(),desc:t.purchaseOverlay.find(t.paywallDesc).text().trim(),name:t.paywallName.text().trim(),applies:e(t.paywallAppliesTo).val(),specific_posts:p,preview_id:t.postPreviewWrapper.attr("data-preview-id")},d={action:"rg_update_paywall",post_id:t.postPreviewWrapper.attr("data-access-id"),paywall:u,individual:r,time_passes:i,subscriptions:c,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};W(revenueGeneratorGlobalOptions.ajaxUrl,d)})),t.body.on("click",t.reVerifyAccount,(function(e){e.preventDefault(),s()})),t.activatePaywall.on("click",(function(){if(0===parseInt(revenueGeneratorGlobalOptions.globalOptions.is_merchant_verified))s();else{let n;const r=e(t.purchaseOptionItem);let o=!1;e.each(r,(function(t,a){const r=e(a),i=r.attr("data-purchase-type");switch(i){case"individual":n=r.attr("data-paywall-id");break;case"timepass":n=r.attr("data-tlp-id");break;case"subscription":n=r.attr("data-sub-id")}o||n||"individual"===i||(o=!0)})),o?_("newPurchaseOption").then(e=>{if(!0!==e)return!1;t.isPublish=!0,t.savePaywall.trigger("click"),t.savePaywall.addClass("hide"),f(),setTimeout((function(){a(),m(),t.isPublish=!1}),1500)}):(t.isPublish=!0,t.savePaywall.trigger("click"),t.savePaywall.addClass("hide"),f(),setTimeout((function(){a(),m(),t.isPublish=!1}),1500))}})),t.body.on("click",t.connectAccount,(function(){i(),rgGlobal.sendLPGAEvent("Connect Account","LP RevGen Account","Connect Account",0,!0)})),t.body.on("click",t.accountSignup,(function(){if(revenueGeneratorGlobalOptions.globalOptions.merchant_region.length){const e=revenueGeneratorGlobalOptions.globalOptions.merchant_region,t=revenueGeneratorGlobalOptions.signupURL;"US"===e?window.open(t.US,"_blank"):window.open(t.EU,"_blank"),i()}rgGlobal.sendLPGAEvent("Connect Account","LP RevGen Account","Signup",0,!0)})),t.body.on("click",t.activateSignup,(function(){if(revenueGeneratorGlobalOptions.globalOptions.merchant_region.length){const e=revenueGeneratorGlobalOptions.globalOptions.merchant_region,t=revenueGeneratorGlobalOptions.signupURL;"US"===e?window.open(t.US,"_blank"):window.open(t.EU,"_blank")}})),t.body.on("click",t.warningSignup,(function(){if(revenueGeneratorGlobalOptions.globalOptions.merchant_region.length){const e=revenueGeneratorGlobalOptions.globalOptions.merchant_region,t=revenueGeneratorGlobalOptions.signupURL;"US"===e?window.open(t.US,"_blank"):window.open(t.EU,"_blank")}})),t.body.on("click",t.activationModalClose,(function(){t.previewWrapper.find(t.activationModal).remove(),t.body.removeClass("modal-blur"),t.contributionBox.removeClass("modal-blur"),t.body.find("input").removeClass("input-blur"),t.purchaseOverlay.css({filter:"unset","pointer-events":"unset"}),t.actionsWrapper.css({"background-color":"#fff"}),t.actionButtons.css({opacity:"1"}),t.searchContentWrapper.css({"background-color":"#fff"})})),t.body.on("input change",t.accountActionId,(function(){const n=t.previewWrapper.find(t.activationModal),a=n.find(t.accountActionId).val().trim(),r=n.find(t.accountActionKey).val().trim();a.length&&r.length&&e(t.activateAccount).removeAttr("disabled")})),t.body.on("input change",t.accountActionKey,(function(){const n=t.previewWrapper.find(t.activationModal),a=n.find(t.accountActionId).val().trim(),r=n.find(t.accountActionKey).val().trim();a.length&&r.length&&e(t.activateAccount).removeAttr("disabled")})),t.body.on("click",t.activateAccount,(function(){const e=t.previewWrapper.find(t.activationModal),n=e.find(t.accountActionId).val().trim(),a=e.find(t.accountActionKey).val().trim();r(n,a)})),t.body.on("click",t.viewPost,(function(){const a=e(this).attr("data-target-id"),r=t.searchPaywallContent.val(),o=e(t.paywallAppliesTo).val(),i=t.searchPost.val();a&&n(a,r,o,i)})),t.body.on("click",t.viewDashboard,(function(){const t=e(this).attr("data-dashboard-url");t&&(location.href=t)})),function(){if(t.postContent){t.postContent.addClass("blur-content");const e=wp.template("revgen-purchase-overlay");t.purchaseOverlay.append(e),t.purchaseOverlay.show()}}()}()}))}(jQuery),function(e){e((function(){!function(){const t={body:e("body"),requestSent:!1,paywallContent:".rev-gen-dashboard-content",paywallPreview:".rev-gen-dashboard-content-paywall-preview",paywallContentWrapper:".rev-gen-dashboard-content-paywall",removePaywallDashboard:".rev-gen-dashboard-remove-paywall",newPaywall:e("#rg_js_newPaywall"),newContribution:e("#rg_js_newContribution"),sortPaywalls:e("#rg_js_filterPaywalls"),searchPaywall:e("#rg_js_searchPaywall"),editPayWallName:e(".rev-gen-dashboard-paywall-name"),paywallSearchIcon:e(".rev-gen-dashboard-bar--search-icon"),laterpayLoader:e(".laterpay-loader-wrapper"),contributionDelete:e(".rev-gen-dashboard__contribution-delete"),restartTour:e("#rg_js_RestartTutorial"),restartTourContribution:e("#rg_js_RestartTutorial_Contribution"),snackBar:e("#rg_js_SnackBar")},n=function(){t.laterpayLoader.css({display:"flex"})},a=function(n){if(!t.requestSent)if(t.requestSent=!0,n.length){const a={action:"rg_search_paywall",rg_current_url:window.location.href,search_term:n,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:a,dataType:"json"}).done((function(e){t.requestSent=!1,!0===e.success&&e.redirect_to&&(window.location.href=e.redirect_to)}))}else{const e=new URL(window.location.href),t=e.searchParams;t.delete("search_term"),e.search=t.toString();const n=e.toString();window.location.href=n}};t.body.on("click",t.paywallPreview,(function(){const n=e(this).closest(t.paywallContentWrapper).attr("data-paywall-id");n&&(window.location.href=revenueGeneratorGlobalOptions.paywallPageBase+"&current_paywall="+n)})),t.restartTour.on("click",(function(){const n={action:"rg_restart_tour",tour_type:"is_paywall_tutorial_completed",restart_tour:"1",security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(e){!0===e.success&&(window.location=t.newPaywall.attr("href"))}))})),t.restartTourContribution.on("click",(function(){const n={action:"rg_restart_tour",tour_type:"is_contribution_tutorial_completed",restart_tour:"1",security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(e){!0===e.success&&(window.location=t.newContribution.attr("href"))}))})),t.sortPaywalls.on("change",(function(){const t=e(this).val(),n={action:"rg_set_paywall_order",rg_current_url:window.location.href,rg_sort_order:t,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(e){!0===e.success&&e.redirect_to&&(window.location.href=e.redirect_to)}))})),t.searchPaywall.on("focus",(function(){e(t.paywallContent).addClass("blury"),t.body.css({height:"100%"}),e(this).val().trim().length&&t.searchPaywall.trigger("change")})),t.searchPaywall.on("focusout",(function(){t.body.css({height:"auto"}),e(t.paywallContent).removeClass("blury")})),e(t.paywallContent).on("click",(function(){t.body.css({overflow:"auto",height:"auto"}),e(t.paywallContent).removeClass("blury")})),t.paywallSearchIcon.on("click",(function(){n();const e=t.searchPaywall.val().trim();a(e)})),t.searchPaywall.on("keyup",(function(e){13===e.keyCode&&t.paywallSearchIcon.trigger("click")})),t.editPayWallName.on("focusout",(function(){if(!t.requestSent){t.requestSent=!0,e(t.paywallContent).addClass("blury"),t.body.css({overflow:"hidden",height:"100%"});const n={action:"rg_set_paywall_name",new_paywall_name:e(this).text().trim(),paywall_id:e(this).closest(t.paywallContentWrapper).attr("data-paywall-id"),security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:n,dataType:"json"}).done((function(n){t.snackBar.showSnackbar(n.msg,1500),t.body.css({overflow:"auto",height:"auto"}),e(t.paywallContent).removeClass("blury"),t.requestSent=!1}))}})),t.editPayWallName.on("keydown",(function(t){if(20<=e(this).text().trim().length)switch(t.keyCode){case 8:case 9:case 13:case 37:case 38:case 39:case 40:break;default:const e=new RegExp("^[a-zA-Z0-9.,/ $@()]+$"),n=t.key;if(e.test(n))return t.preventDefault(),!1}})),t.contributionDelete.on("click",(function(n){n.preventDefault();const a=e(n.target),r=a.data("id"),o=a.data("nonce");new C({id:"rg-modal-remove-contribution",templateData:{isEditable:parseInt(a.data("editable"),10)},onConfirm:async()=>{e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,data:{action:"rg_contribution_delete",security:o,id:r},success:e=>{t.snackBar.showSnackbar(e.data.msg,1500),setTimeout(()=>{window.location.reload()},1500)}})},onCancel:()=>{}})})),t.body.on("click",t.removePaywallDashboard,(function(){const n=e(this).attr("data-paywall-id"),a=e(this).closest(".rev-gen-dashboard-content-paywall-info").find(".rev-gen-dashboard-paywall-name").text().trim();new C({id:"rg-modal-remove-paywall",onConfirm:async()=>{e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:{action:"rg_remove_paywall",id:n,security:revenueGeneratorGlobalOptions.rg_paywall_nonce},success:e=>{t.snackBar.showSnackbar(e.msg,1500),rgGlobal.sendLPGAEvent("Paywall Deleted","LP RevGen Configure Paywall",a,0,!0),setTimeout((function(){window.location.reload()}),1500)}})},onCancel:()=>{}})}))}()}))}(jQuery),function(e){e((function(){!function(){const t={body:e("body"),requestSent:!1,contributionBox:e(".rev-gen-contribution-main--box"),contributionRequiredField:"h3[contenteditable], p[contenteditable], #rg_contribution_title",contributionHelpButton:".rev-gen-contribution-main--help",contributionHelpModal:".rev-gen-contribution-main-info-modal",contributionModalClose:".rev-gen-contribution-main-info-modal-cross",contributionCampaignNameLabel:e("#rg_contribution_campaign_name"),contributionThankYouPageLabel:e("#rg_contribution_thankyou_label"),contributionGenerateButtonLabel:e("#rg_contribution_generate"),contributionHelpGenerate:e("#rev-gen-contribution-help-generate"),contributionDashboardShortcodeLink:e(".rev-gen-dashboard__link--copy-shortcode"),contributionDashboardCode:".rev-gen-dashboard-content-contribution-code",helpGAModal:".rev-gen-settings-main-info-modal",activationModal:".rev-gen-preview-main-account-modal",accountActionId:".rev-gen-preview-main-account-modal-fields-merchant-id",accountActionKey:".rev-gen-preview-main-account-modal-fields-merchant-key",exitTour:".rev-gen-exit-tour",laterpayLoader:e(".laterpay-loader-wrapper"),rgLayoutWrapper:e(".rev-gen-layout-wrapper"),rgContributionWrapper:e(".rev-gen-contribution-main"),form:e(".rev-gen-contribution-form"),contributionTitle:e(".rev-gen-contribution-main--box-header"),contributionTitleInput:e('[name="dialog_header"]'),contributionDescription:e(".rev-gen-contribution-main--box-description"),contributionDescriptionInput:e('[name="dialog_description"]'),contributionAmounts:e(".rev-gen-contribution-main--box-donation-amount"),allAmountsInput:e('[name="amounts"]'),saveButton:e(".rev-gen-contribution-main-generate-button"),contributionCampaignName:e("#rg_contribution_title"),contributionThankYouPage:e("#rg_contribution_thankyou"),contributionCopyMessage:e(".rev-gen-contribution-main-copy-message"),snackBar:e("#rg_js_SnackBar"),emailSupportButton:e(".rev-gen-email-support")},n=function(){e(t.contributionHelpModal).remove(),e("[data-has-help]").removeClass("highlighted"),t.contributionBox.removeClass("faded"),t.body.removeClass("modal-blur"),t.body.find("input").removeClass("input-blur")},a=function(){e(document).ready((function(){if(t.rgContributionWrapper.length>0&&0===parseInt(revenueGeneratorGlobalOptions.globalOptions.is_contribution_tutorial_completed)){const e=r();s(e),c(e)}})),t.contributionTitle.on("keyup",(function(){t.contributionTitleInput.val(t.contributionTitle.text()),t.form.trigger("change")})),t.contributionDescription.on("keyup",(function(){t.contributionDescriptionInput.val(t.contributionDescription.text()),t.form.trigger("change")})),e("input",t.form).on("keyup",(function(){t.form.trigger("change")})),t.form.on("submit",(function(n){if(n.preventDefault(),"invalid"===g())return n.preventDefault(),!1;if(0===parseInt(revenueGeneratorGlobalOptions.globalOptions.is_merchant_verified))return p(),n.preventDefault(),!1;if(!t.requestSent){t.requestSent=!0,o();const n=f();t.allAmountsInput.val(n);const a=t.form.serialize();return e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:a,dataType:"json"}).done((function(n){if(t.snackBar.showSnackbar(n.msg,1500),n.success){d(n.code),t.saveButton.text(n.button_text),t.saveButton.removeClass("enabled"),t.saveButton.prop("disabled",!0),t.contributionCopyMessage.show(),t.body.removeClass("modal-blur"),t.body.find("input").removeClass("input-blur");let r=revenueGeneratorGlobalOptions.merchant_id;!r&&e(t.accountActionId).val()&&(r=e(t.accountActionId).val());const o="New ShortCode\t",i="LP RevGen Contributions";let s=r+" - "+a.heading;t.contributionAmounts.each((function(){const t=e(this).text().trim();if("custom"===t)return!0;s+=" - "+t})),rgGlobal.sendLPGAEvent(o,i,s,0,!0),window.location.href!==n.edit_link&&setTimeout((function(){window.location.href=n.edit_link}),1500)}t.requestSent=!1,i()})),!1}})),t.contributionThankYouPage.on("focusout",(function(){const t=e(this).val();""!==t&&(u(t)||h(e(this)))})),t.contributionAmounts.on("focusout",(function(){const n=e(this).text().trim(),a=v(n);e(this).text(a),t.form.trigger("change")})),e(t.contributionRequiredField).on("focusout",(function(){(e(this).is("input")?e(this).val():e(this).text().trim())||h(e(this))})),t.contributionDashboardShortcodeLink.on("click",(function(n){n.preventDefault();const a=e(this).attr("data-shortcode");d(a),t.snackBar.showSnackbar(revenueGeneratorGlobalOptions.rg_code_copy_msg,1500)})),t.body.on("click",t.contributionHelpButton,(function(){const n=e(this).attr("data-info-for"),a=t.rgContributionWrapper.find(t.contributionHelpModal);let r="";if(a.length)t.body.removeClass("modal-blur"),t.body.find("input").removeClass("input-blur"),a.remove();else{const a=wp.template(`revgen-info-${n}`);switch(t.rgContributionWrapper.append(a),t.body.addClass("modal-blur"),t.body.find("input").addClass("input-blur"),t.contributionBox.addClass("faded"),n){case"campaignName":r="Campaign name",e("input",t.contributionCampaignNameLabel).removeClass("input-blur"),t.contributionGenerateButtonLabel.removeClass("highlighted"),t.contributionThankYouPageLabel.removeClass("highlighted"),t.contributionCampaignNameLabel.addClass("highlighted");break;case"shortcode":r="Generate Shortcode",e("input",t.contributionGenerateButtonLabel).removeClass("input-blur"),t.contributionGenerateButtonLabel.addClass("highlighted");break;case"thankYouPage":r="Thank you page",e("input",t.contributionThankYouPageLabel).removeClass("input-blur"),t.contributionCampaignNameLabel.removeClass("highlighted"),t.contributionGenerateButtonLabel.removeClass("highlighted"),t.contributionThankYouPageLabel.addClass("highlighted")}const o="LP RevGen Contributions",i="Help";rgGlobal.sendLPGAEvent(i,o,r,0,!0)}})),t.rgLayoutWrapper.on("click",(function(){e(t.contributionHelpModal)&&e(t.contributionHelpModal).length>0&&n()})),t.body.on("click",t.contributionModalClose,(function(){n()})),t.form.on("change",(function(){"valid"===g()&&t.saveButton.addClass("enabled").prop("disabled",!1)})),e(t.contributionHelpGenerate).on("click",(function(){rgGlobal.sendLPGAEvent("Help","LP RevGen Contributions","Generate code",0)}))},r=function(){return new Shepherd.Tour({defaultStepOptions:{classes:"rev-gen-tutorial-card",scrollTo:!0,scrollToHandler:t=>{e("html, body").animate({scrollTop:e(t).offset().top-e(window).height()/2-e(t).height()},1e3)}}})},o=function(){t.laterpayLoader.css({display:"flex"})},i=function(){t.laterpayLoader.hide()},s=function(t){const n={text:G("Skip Tour","revenue-generator"),action:t.complete,classes:"shepherd-content-skip-tour"},a={text:G("Next >","revenue-generator"),action:t.next,classes:"shepherd-content-next-tour-element"},r="LP RevGen Contributions Tutorial",o=t.addStep({id:"rg-contribution-header-description",text:G("Click to edit","revenue-generator"),attachTo:{element:"#rev-gen-contribution-main-header-section",on:"top"},arrow:!0,classes:"rev-gen-tutorial-contribution-title fade-in",buttons:[n,a],when:{hide(){rgGlobal.sendLPGAEvent("1 - Text Edit",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=o.options.classes;o.options.classes=e.replace("fade-in","fade-out"),o.updateStepOptions(o.options)}).on("hide",()=>{e(o.el).removeAttr("hidden"),setTimeout((function(){e(o.el).attr("hidden","")}),700)}),i=t.addStep({id:"rg-contribution-amount-first",text:G("Click to edit each amount","revenue-generator"),attachTo:{element:".rev-gen-contribution-main--box-donation:first-child",on:"top"},arrow:!0,classes:"rev-gen-tutorial-contribution-title fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("2 - Amount Edit",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=i.options.classes;i.options.classes=e.replace("fade-in","fade-out"),i.updateStepOptions(i.options)}).on("hide",()=>{e(i.el).removeAttr("hidden"),setTimeout((function(){e(i.el).attr("hidden","")}),700)}),s=t.addStep({id:"rg-contribution-amount-second",text:x(G("Amounts less than $5 will default to %1$s pay later %2$s","revenue-generator"),'<a target="_blank" href="https://www.laterpay.net/academy/getting-started-with-laterpay-the-difference-between-pay-now-pay-later">',"</a>"),attachTo:{element:".rev-gen-contribution-main--box-donation:nth-child(2)",on:"top"},arrow:!0,classes:"rev-gen-tutorial-contribution-title fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("3 - PN v PL",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=s.options.classes;s.options.classes=e.replace("fade-in","fade-out"),s.updateStepOptions(s.options)}).on("hide",()=>{e(s.el).removeAttr("hidden"),setTimeout((function(){e(s.el).attr("hidden","")}),700)}),c=t.addStep({id:"rg-contribution-campaign-name",text:G("Enter the description that you would like to appear on your customer's invoice","revenue-generator"),attachTo:{element:"#rg_contribution_campaign_name",on:"top"},arrow:!0,classes:"rev-gen-tutorial-contribution-title fade-in",buttons:[a],when:{hide(){rgGlobal.sendLPGAEvent("4 - Campaign Name",r,"Continue",0,!0)}}}).on("before-hide",()=>{const e=c.options.classes;c.options.classes=e.replace("fade-in","fade-out"),c.updateStepOptions(c.options)}).on("hide",()=>{e(c.el).removeAttr("hidden"),setTimeout((function(){e(c.el).attr("hidden","")}),700)}),l=t.addStep({id:"rg-contribution-generate-button",text:x(G("When you’re ready, click here to copy your customized %1$s shortcode %2$s","revenue-generator"),'<a target="_blank" href="https://wordpress.com/support/shortcodes/">',"</a>"),attachTo:{element:".rev-gen-contribution-main-generate-button",on:"right"},arrow:!0,classes:"fade-in",buttons:[{text:G("Complete","revenue-generator"),action:t.next,classes:"shepherd-content-complete-tour-element"}],when:{hide(){rgGlobal.sendLPGAEvent("5 - Generate Code",r,"Complete",0,!0)}}}).on("before-hide",()=>{const e=l.options.classes;l.options.classes=e.replace("fade-in","fade-out"),l.updateStepOptions(l.options)}).on("hide",()=>{e(l.el).removeAttr("hidden"),setTimeout((function(){e(l.el).attr("hidden","")}),700)})},c=function(n){e(t.exitTour).css({visibility:"visible","pointer-events":"all",cursor:"pointer"}),t.body.addClass("modal-blur"),t.body.find("input").addClass("input-blur"),t.body.find('*[contenteditable="true"]').removeAttr("contenteditable"),t.contributionBox.addClass("faded"),t.rgContributionWrapper.css({"pointer-events":"none"}),t.emailSupportButton.hide();const a=["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"],r=function(e){if(a.includes(e.key))return e.preventDefault(),!1};e(document).keydown(r),Shepherd.on("complete",(function(){t.body.removeClass("modal-blur"),t.body.find("input").removeClass("input-blur"),t.contributionBox.removeClass("faded"),t.rgContributionWrapper.css({"pointer-events":"unset"}),e(t.exitTour).remove(),t.emailSupportButton.hide(),e(document).unbind("keydown",r);let n="",a="Exit Tour";switch(Shepherd.activeTour.getCurrentStep().id){case"rg-contribution-header-description":n="1 - Text Edit";break;case"rg-contribution-amount-first":n="2 - Amount Edit";break;case"rg-contribution-amount-second":n="3 - PN v PL";break;case"rg-contribution-campaign-name":n="4 - Campaign Name";break;case"rg-contribution-generate-button":n="5 - Generate Code",a="Complete"}rgGlobal.sendLPGAEvent(n,"LP RevGen Contributions Tutorial",a,0,!0),setTimeout((function(){l()}),500)})),n.start()},l=function(){const t={action:"rg_complete_tour",config_key:"is_contribution_tutorial_completed",config_value:1,security:revenueGeneratorGlobalOptions.rg_paywall_nonce};e.ajax({url:revenueGeneratorGlobalOptions.ajaxUrl,method:"POST",data:t,dataType:"json"}).done((function(e){e.success&&location.reload()}))},p=function(){t.rgContributionWrapper.find(t.activationModal).remove();const e=wp.template("revgen-account-activation-modal");t.rgContributionWrapper.append(e),t.body.addClass("modal-blur"),t.contributionBox.addClass("modal-blur"),t.body.find("input").not(t.accountActionId+","+t.accountActionKey).addClass("input-blur")},u=function(e){return null!==e.match(/(http(s)?:\/\/.)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)},d=function(n){const a=e("<input>");t.body.append(a),a.val(n).select(),document.execCommand("copy"),a.remove()},h=function(t){e(t).css("border","1px solid #ff1939"),setTimeout((function(){e(t).removeAttr("style")}),5e3)},g=function(){let n="valid";return e(t.contributionRequiredField).each((function(){const t=e(this).is("input")?e(this).val():e(this).text().trim(),a=e(this).attr("id");"rg_contribution_thankyou"===String(a)?u(t)||(h(e(this)),n="invalid"):t||(h(e(this)),n="invalid")})),n},v=function(e){"number"!=typeof e&&(e=e.replace(/[^0-9\,\.]/g,""),e=parseFloat(e.replace(",",".")).toFixed(2)),isNaN(e)&&(e=0);const t=parseFloat(0),n=parseFloat(1e3);return parseFloat(e)<t||isNaN(parseFloat(e))?e=t:parseFloat(e)>n&&(e=n),e=(e=Math.abs(e)).toFixed(2),-1!==revenueGeneratorGlobalOptions.locale.indexOf("de_DE")&&(e=e.replace(".",",")),e},f=function(){const n=t.contributionAmounts,a=[];return n.length>0&&n.each((function(t){let n=e(this).text().trim();if("custom"===n)return!0;const r={};parseFloat(n)>0&&(n*=100,r.price=n),r.revenue=n>199?"sis":"ppu",r.is_selected=0===t,a.push(r)})),JSON.stringify(a)};a()}()}))}(jQuery)}]);